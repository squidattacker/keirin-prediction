[0m13:39:43.035828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efff89291d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb1d3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efff8a253d0>]}


============================== 13:39:43.046447 | 7958eeca-d631-42be-93e7-9e6edb4d11e8 ==============================
[0m13:39:43.046447 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:39:43.047418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspace/app/winticket_dbt/logs', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:43.167497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7958eeca-d631-42be-93e7-9e6edb4d11e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efff85b9110>]}
[0m13:39:43.185233 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x758o3zc'
[0m13:39:43.185957 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:39:43.517433 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:39:43.522032 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:39:43.579492 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:39:43.601530 [info ] [MainThread]: Updating lock file in file path: /workspace/app/winticket_dbt/package-lock.yml
[0m13:39:43.604288 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e9jx2_j3'
[0m13:39:43.609331 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:39:43.927708 [info ] [MainThread]: Installed from version 1.3.0
[0m13:39:43.928197 [info ] [MainThread]: Updated version available: 1.3.2
[0m13:39:43.928892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7958eeca-d631-42be-93e7-9e6edb4d11e8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffaba9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efff93c6750>]}
[0m13:39:43.929428 [info ] [MainThread]: 
[0m13:39:43.929772 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:39:43.933785 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9615082, "process_in_blocks": "0", "process_kernel_time": 0.47429, "process_mem_max_rss": "102496", "process_out_blocks": "0", "process_user_time": 2.306089}
[0m13:39:43.934453 [debug] [MainThread]: Command `dbt deps` succeeded at 13:39:43.934205 after 0.96 seconds
[0m13:39:43.935267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffccc5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffccc4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffccc4f10>]}
[0m13:39:43.935792 [debug] [MainThread]: Flushing usage events
[0m13:39:44.753964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:55.088943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bce644d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bd0bd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bce98710>]}


============================== 13:39:55.096750 | 499b06f2-d247-464f-8a41-514c4ba1dd92 ==============================
[0m13:39:55.096750 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:39:55.097465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspace/app/winticket_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:55.660156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bcee4e50>]}
[0m13:39:55.721447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bf83f1d0>]}
[0m13:39:55.723523 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:39:55.872169 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:39:55.873172 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:39:55.873668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bcef54d0>]}
[0m13:39:57.211626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bcea8690>]}
[0m13:39:57.275234 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:39:57.277884 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:39:57.304330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bcf0cdd0>]}
[0m13:39:57.304982 [info ] [MainThread]: Found 9 models, 543 macros
[0m13:39:57.305404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bce7fe10>]}
[0m13:39:57.307621 [info ] [MainThread]: 
[0m13:39:57.308033 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:57.308500 [info ] [MainThread]: 
[0m13:39:57.309057 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:39:57.314821 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:39:57.320824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:39:57.327428 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:39:57.395715 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:39:57.396203 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:39:57.396587 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:39:57.396950 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:39:57.397355 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:39:57.397708 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:39:57.398015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:57.398378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:57.398687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:00.558490 [debug] [ThreadPool]: SQL status: OK in 3.160 seconds
[0m13:40:00.559202 [debug] [ThreadPool]: SQL status: OK in 3.161 seconds
[0m13:40:00.560963 [debug] [ThreadPool]: On list_winticket: Close
[0m13:40:00.562373 [debug] [ThreadPool]: On list_winticket: Close
[0m13:40:00.564152 [debug] [ThreadPool]: SQL status: OK in 3.165 seconds
[0m13:40:00.566276 [debug] [ThreadPool]: On list_winticket: Close
[0m13:40:00.570461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m13:40:00.570980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m13:40:00.571436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m13:40:00.572047 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m13:40:00.572605 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m13:40:00.573165 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m13:40:00.581892 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:40:00.584356 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:40:00.587814 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:40:00.588431 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:40:00.588862 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:40:00.589290 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:40:00.589634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.589981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.590383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.664304 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m13:40:00.664936 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m13:40:00.665417 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m13:40:00.666973 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:40:00.668491 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:40:00.669756 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:40:00.670083 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m13:40:00.670517 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m13:40:00.670868 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m13:40:00.671789 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:00.672487 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:00.672968 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:00.673270 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:40:00.673638 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:40:00.673957 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:40:00.674266 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m13:40:00.674617 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m13:40:00.674944 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m13:40:00.675914 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:40:00.677133 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:40:00.677538 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:40:00.677847 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:40:00.678087 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:40:00.678979 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:40:00.679435 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:40:00.680690 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:40:00.681259 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:40:00.682505 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:40:00.681880 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:40:00.683313 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:40:00.689050 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m13:40:00.689838 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m13:40:00.690905 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:40:00.691553 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m13:40:00.692493 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:40:00.692851 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m13:40:00.706764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_gold)
[0m13:40:00.707606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_bronze)
[0m13:40:00.708297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_silver)
[0m13:40:00.717089 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:40:00.719930 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:40:00.722203 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:40:00.722678 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m13:40:00.723034 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m13:40:00.723462 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m13:40:00.723852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.724325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.724637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:00.787476 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m13:40:00.788030 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m13:40:00.788659 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m13:40:00.788397 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:40:00.788977 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:40:00.789656 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m13:40:00.789354 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:40:00.789962 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m13:40:00.792515 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m13:40:00.811301 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:40:00.812300 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:40:00.813035 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:40:00.814908 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m13:40:00.816476 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m13:40:00.817636 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m13:40:00.820715 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m13:40:00.821220 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m13:40:00.821691 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m13:40:00.822030 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m13:40:00.822369 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m13:40:00.822687 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m13:40:00.826839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b692e290>]}
[0m13:40:00.827647 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:00.827969 [debug] [MainThread]: On master: BEGIN
[0m13:40:00.828271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:00.888695 [debug] [MainThread]: SQL status: OK in 0.060 seconds
[0m13:40:00.889234 [debug] [MainThread]: On master: COMMIT
[0m13:40:00.889595 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:00.889853 [debug] [MainThread]: On master: COMMIT
[0m13:40:00.890413 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:00.890724 [debug] [MainThread]: On master: Close
[0m13:40:00.894766 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m13:40:00.895302 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m13:40:00.895954 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m13:40:00.896776 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m13:40:00.897530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_race_results)
[0m13:40:00.898027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.bronze_racecards)
[0m13:40:00.898472 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m13:40:00.898874 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m13:40:00.908492 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m13:40:00.914945 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m13:40:00.916087 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m13:40:00.916438 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m13:40:00.978001 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m13:40:00.978948 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m13:40:00.982428 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:40:00.980883 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:40:00.983948 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m13:40:00.986515 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m13:40:00.989318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:40:00.990982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:01.132076 [debug] [Thread-2 (]: SQL status: OK in 0.143 seconds
[0m13:40:01.133600 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:40:01.134274 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json');
  );

[0m13:40:01.142356 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json');
  );

[0m13:40:01.143084 [debug] [Thread-1 (]: SQL status: OK in 0.152 seconds
[0m13:40:01.143696 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:40:01.144293 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:40:01.145186 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: ROLLBACK
[0m13:40:01.145772 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json');
  );

[0m13:40:01.155035 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json');
  );

[0m13:40:01.156028 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:40:01.156951 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: ROLLBACK
[0m13:40:01.180803 [debug] [Thread-1 (]: Failed to rollback 'model.winticket_dbt.bronze_race_results'
[0m13:40:01.182986 [debug] [Thread-2 (]: Failed to rollback 'model.winticket_dbt.bronze_racecards'
[0m13:40:01.183568 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m13:40:01.184164 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m13:40:01.189043 [debug] [Thread-1 (]: Runtime Error in model bronze_race_results (models/bronze/bronze_race_results.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 16: ...('/workspace/app/data/winticket_lake/bronze/results/*.json');
                                                                          ^
[0m13:40:01.198165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b4416cd0>]}
[0m13:40:01.199791 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model main_bronze.bronze_race_results ........... [[31mERROR[0m in 0.30s]
[0m13:40:01.202293 [debug] [Thread-2 (]: Runtime Error in model bronze_racecards (models/bronze/bronze_racecards.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 16: ...('/workspace/app/data/winticket_lake/bronze/racecards/*.json');
                                                                            ^
[0m13:40:01.203272 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m13:40:01.204097 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '499b06f2-d247-464f-8a41-514c4ba1dd92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b44b3190>]}
[0m13:40:01.205140 [debug] [Thread-7 (]: Marking all children of 'model.winticket_dbt.bronze_race_results' to be skipped because of status 'error'.  Reason: Runtime Error in model bronze_race_results (models/bronze/bronze_race_results.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 16: ...('/workspace/app/data/winticket_lake/bronze/results/*.json');
                                                                          ^.
[0m13:40:01.206185 [error] [Thread-2 (]: 2 of 9 ERROR creating sql view model main_bronze.bronze_racecards .............. [[31mERROR[0m in 0.31s]
[0m13:40:01.208598 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m13:40:01.209753 [debug] [Thread-7 (]: Marking all children of 'model.winticket_dbt.bronze_racecards' to be skipped because of status 'error'.  Reason: Runtime Error in model bronze_racecards (models/bronze/bronze_racecards.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 16: ...('/workspace/app/data/winticket_lake/bronze/racecards/*.json');
                                                                            ^.
[0m13:40:01.210402 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m13:40:01.212657 [info ] [Thread-4 (]: 3 of 9 SKIP relation main_silver.silver_race_results ........................... [[33mSKIP[0m]
[0m13:40:01.212044 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_entries
[0m13:40:01.214110 [info ] [Thread-2 (]: 5 of 9 SKIP relation main_silver.silver_race_entries ........................... [[33mSKIP[0m]
[0m13:40:01.213399 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m13:40:01.211484 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m13:40:01.215340 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m13:40:01.214755 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m13:40:01.215962 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m13:40:01.217091 [info ] [Thread-1 (]: 4 of 9 SKIP relation main_silver.silver_exacta_odds ............................ [[33mSKIP[0m]
[0m13:40:01.220667 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m13:40:01.219794 [info ] [Thread-4 (]: 7 of 9 SKIP relation main_silver.silver_tipster_predictions .................... [[33mSKIP[0m]
[0m13:40:01.218540 [info ] [Thread-3 (]: 6 of 9 SKIP relation main_silver.silver_race_metadata .......................... [[33mSKIP[0m]
[0m13:40:01.221373 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m13:40:01.222939 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m13:40:01.223518 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m13:40:01.224378 [info ] [Thread-2 (]: 8 of 9 SKIP relation main_silver.silver_head_to_head ........................... [[33mSKIP[0m]
[0m13:40:01.225638 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m13:40:01.227029 [debug] [Thread-1 (]: Began running node model.winticket_dbt.gold_entry_features
[0m13:40:01.227650 [info ] [Thread-1 (]: 9 of 9 SKIP relation main_gold.gold_entry_features ............................. [[33mSKIP[0m]
[0m13:40:01.228459 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m13:40:01.235655 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:01.236275 [debug] [MainThread]: On master: BEGIN
[0m13:40:01.236721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:01.334590 [debug] [MainThread]: SQL status: OK in 0.098 seconds
[0m13:40:01.335318 [debug] [MainThread]: On master: COMMIT
[0m13:40:01.335836 [debug] [MainThread]: Using duckdb connection "master"
[0m13:40:01.336402 [debug] [MainThread]: On master: COMMIT
[0m13:40:01.337335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:40:01.337832 [debug] [MainThread]: On master: Close
[0m13:40:01.341640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:01.342274 [debug] [MainThread]: Connection 'list_winticket_main_bronze' was properly closed.
[0m13:40:01.342681 [debug] [MainThread]: Connection 'model.winticket_dbt.bronze_race_results' was properly closed.
[0m13:40:01.343011 [debug] [MainThread]: Connection 'model.winticket_dbt.bronze_racecards' was properly closed.
[0m13:40:01.343502 [info ] [MainThread]: 
[0m13:40:01.344063 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m13:40:01.345488 [debug] [MainThread]: Command end result
[0m13:40:01.374432 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:40:01.376813 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:40:01.382912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m13:40:01.383308 [info ] [MainThread]: 
[0m13:40:01.383905 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:40:01.384480 [info ] [MainThread]: 
[0m13:40:01.385066 [error] [MainThread]:   Runtime Error in model bronze_race_results (models/bronze/bronze_race_results.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 16: ...('/workspace/app/data/winticket_lake/bronze/results/*.json');
                                                                          ^
[0m13:40:01.385569 [info ] [MainThread]: 
[0m13:40:01.386107 [error] [MainThread]:   Runtime Error in model bronze_racecards (models/bronze/bronze_racecards.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 16: ...('/workspace/app/data/winticket_lake/bronze/racecards/*.json');
                                                                            ^
[0m13:40:01.386509 [info ] [MainThread]: 
[0m13:40:01.387104 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=7 TOTAL=9
[0m13:40:01.392468 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.356139, "process_in_blocks": "0", "process_kernel_time": 1.392998, "process_mem_max_rss": "260980", "process_out_blocks": "0", "process_user_time": 5.669217}
[0m13:40:01.393194 [debug] [MainThread]: Command `dbt run` failed at 13:40:01.393062 after 6.36 seconds
[0m13:40:01.393716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88b6888990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c142fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bce5d110>]}
[0m13:40:01.394104 [debug] [MainThread]: Flushing usage events
[0m13:40:02.205486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:41.026089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694af64990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694b1bd190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694af5dc50>]}


============================== 13:42:41.037164 | 97071689-81af-4d0f-9025-6536a5794156 ==============================
[0m13:42:41.037164 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:42:41.037899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspace/app/winticket_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:42:41.605755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694b00c9d0>]}
[0m13:42:41.665741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694d93f050>]}
[0m13:42:41.668669 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:42:41.811792 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:42:41.990974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
[0m13:42:41.992064 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/bronze/bronze_race_results.sql
[0m13:42:41.992529 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_exacta_odds.sql
[0m13:42:41.992936 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_race_results.sql
[0m13:42:41.993398 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_tipster_predictions.sql
[0m13:42:41.993806 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_race_metadata.sql
[0m13:42:41.994217 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/bronze/bronze_racecards.sql
[0m13:42:41.994650 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_head_to_head.sql
[0m13:42:41.995016 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/gold/gold_entry_features.sql
[0m13:42:41.995387 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_race_entries.sql
[0m13:42:42.278786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69448232d0>]}
[0m13:42:42.343099 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:42:42.346544 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:42:42.378120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69448c8350>]}
[0m13:42:42.378749 [info ] [MainThread]: Found 9 models, 543 macros
[0m13:42:42.379133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694483f950>]}
[0m13:42:42.381449 [info ] [MainThread]: 
[0m13:42:42.381858 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:42:42.382394 [info ] [MainThread]: 
[0m13:42:42.383304 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:42:42.390803 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:42:42.391640 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:42:42.402949 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:42:42.544264 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:42:42.544822 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:42:42.545126 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:42:42.545490 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:42:42.545868 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:42:42.546212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:42.546601 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:42:42.546916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:42.547458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:44.228133 [debug] [ThreadPool]: SQL status: OK in 1.681 seconds
[0m13:42:44.228779 [debug] [ThreadPool]: SQL status: OK in 1.683 seconds
[0m13:42:44.229206 [debug] [ThreadPool]: SQL status: OK in 1.682 seconds
[0m13:42:44.230669 [debug] [ThreadPool]: On list_winticket: Close
[0m13:42:44.231959 [debug] [ThreadPool]: On list_winticket: Close
[0m13:42:44.233187 [debug] [ThreadPool]: On list_winticket: Close
[0m13:42:44.237561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m13:42:44.238354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m13:42:44.238965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m13:42:44.239899 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m13:42:44.240583 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m13:42:44.241043 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m13:42:44.249886 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:42:44.252643 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:42:44.255546 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:42:44.257579 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:42:44.257003 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:42:44.258485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:44.258007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:44.256371 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:42:44.259353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:44.330131 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m13:42:44.330951 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m13:42:44.332441 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:42:44.333688 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:42:44.334017 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m13:42:44.334373 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m13:42:44.335539 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m13:42:44.336238 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:42:44.336645 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.337761 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:42:44.338828 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m13:42:44.338434 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:42:44.338079 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:42:44.340850 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m13:42:44.340399 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.339740 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m13:42:44.341741 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:42:44.342381 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.342987 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m13:42:44.343419 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.344557 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:42:44.345891 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:42:44.346327 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.346738 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:42:44.347089 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:42:44.347942 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:42:44.348306 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:42:44.348673 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:42:44.349005 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:42:44.349798 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:42:44.350239 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.350725 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.351087 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m13:42:44.351447 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:42:44.351830 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m13:42:44.352545 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m13:42:44.359714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_silver)
[0m13:42:44.360673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_gold)
[0m13:42:44.361338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_bronze)
[0m13:42:44.367821 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:42:44.370028 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:42:44.373126 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:42:44.374517 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m13:42:44.374093 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m13:42:44.375283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:44.374968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:44.373718 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m13:42:44.376450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:44.439826 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m13:42:44.440442 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:42:44.441154 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m13:42:44.442491 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m13:42:44.443446 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:42:44.444136 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m13:42:44.445343 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m13:42:44.445813 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:42:44.446177 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m13:42:44.460917 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:42:44.462550 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m13:42:44.462964 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:42:44.463509 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m13:42:44.464856 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m13:42:44.466347 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m13:42:44.467108 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m13:42:44.467931 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m13:42:44.468361 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m13:42:44.468696 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m13:42:44.469005 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m13:42:44.469332 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m13:42:44.474285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694543fe50>]}
[0m13:42:44.475590 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:44.475939 [debug] [MainThread]: On master: BEGIN
[0m13:42:44.476220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:44.541965 [debug] [MainThread]: SQL status: OK in 0.066 seconds
[0m13:42:44.542525 [debug] [MainThread]: On master: COMMIT
[0m13:42:44.542839 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:44.543171 [debug] [MainThread]: On master: COMMIT
[0m13:42:44.544056 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:42:44.544673 [debug] [MainThread]: On master: Close
[0m13:42:44.548817 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m13:42:44.549342 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m13:42:44.550005 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m13:42:44.550755 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m13:42:44.551545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.bronze_race_results)
[0m13:42:44.552020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.bronze_racecards)
[0m13:42:44.552454 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m13:42:44.552835 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m13:42:44.563648 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m13:42:44.568215 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m13:42:44.569111 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m13:42:44.574974 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m13:42:44.619659 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m13:42:44.620869 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m13:42:44.621710 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:42:44.622123 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m13:42:44.622514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:42:44.623090 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:42:44.623514 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m13:42:44.623840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:44.684124 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m13:42:44.684885 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:42:44.685352 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m13:42:44.685748 [debug] [Thread-1 (]: SQL status: OK in 0.062 seconds
[0m13:42:44.686447 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:42:44.686860 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m13:42:44.734448 [debug] [Thread-2 (]: SQL status: OK in 0.048 seconds
[0m13:42:44.742224 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:42:44.742930 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m13:42:44.744299 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:42:44.755201 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:42:44.755797 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:42:44.756239 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m13:42:44.756638 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:42:44.759897 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:42:44.760803 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m13:42:44.761994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:42:44.763707 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:42:44.764160 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:42:44.764559 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:42:44.765310 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:42:44.771125 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:42:44.771687 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:42:44.772171 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m13:42:44.774838 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:42:44.775661 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m13:42:44.777308 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:42:44.778364 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:42:44.788771 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m13:42:44.792120 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m13:42:44.800752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6944823990>]}
[0m13:42:44.804162 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.24s]
[0m13:42:44.805915 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m13:42:44.807684 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m13:42:44.808493 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m13:42:44.809564 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m13:42:44.810855 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m13:42:44.813680 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_exacta_odds'
[0m13:42:44.815039 [info ] [Thread-3 (]: 4 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m13:42:44.817007 [info ] [Thread-2 (]: 5 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m13:42:44.818562 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m13:42:44.819564 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.silver_race_entries)
[0m13:42:44.820233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f692e3a65d0>]}
[0m13:42:44.820811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m13:42:44.824500 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m13:42:44.825044 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m13:42:44.825851 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.27s]
[0m13:42:44.826901 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m13:42:44.831113 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m13:42:44.831918 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m13:42:44.832325 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m13:42:44.835516 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m13:42:44.836316 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m13:42:44.836782 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m13:42:44.843416 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m13:42:44.844897 [info ] [Thread-1 (]: 6 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m13:42:44.849577 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m13:42:44.850080 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m13:42:44.850956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m13:42:44.851504 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:42:44.856217 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m13:42:44.857055 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:42:44.857811 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m13:42:44.858557 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m13:42:44.859404 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m13:42:44.860163 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:42:44.865521 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:42:44.866213 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:42:44.866741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:42:44.867237 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m13:42:44.868516 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m13:42:44.869126 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:42:44.872853 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:42:44.873896 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:42:44.874238 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m13:42:44.874572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:44.933627 [debug] [Thread-4 (]: SQL status: OK in 0.067 seconds
[0m13:42:44.934430 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:42:44.935013 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first
from prep
group by 1,2
  );

[0m13:42:44.935514 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m13:42:44.935922 [debug] [Thread-3 (]: SQL status: OK in 0.069 seconds
[0m13:42:44.937106 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:42:44.940697 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m13:42:44.943397 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:42:44.942728 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m13:42:44.941304 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:42:44.944178 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from rc
cross join unnest(predictions) as p(pred)
cross join generate_series(1, list_length(pred['order'])) as idx(generate_series)
  );

[0m13:42:44.945717 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m13:42:44.975543 [debug] [Thread-4 (]: SQL status: OK in 0.039 seconds
[0m13:42:44.987040 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:42:44.987674 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m13:42:44.988824 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:42:44.993813 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:42:44.994513 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:42:44.994953 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:42:45.003391 [debug] [Thread-2 (]: SQL status: OK in 0.058 seconds
[0m13:42:45.007911 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:42:45.008540 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m13:42:45.008939 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m13:42:45.012517 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:42:45.014003 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m13:42:45.013159 [debug] [Thread-3 (]: SQL status: OK in 0.065 seconds
[0m13:42:45.015105 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:42:45.023755 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:42:45.025448 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m13:42:45.026152 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m13:42:45.026734 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m13:42:45.027623 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694487d7d0>]}
[0m13:42:45.029017 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:42:45.030148 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.22s]
[0m13:42:45.031091 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:42:45.031615 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:42:45.032176 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m13:42:45.032564 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:42:45.034116 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:42:45.034721 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m13:42:45.035503 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:42:45.036125 [info ] [Thread-4 (]: 7 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m13:42:45.037173 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:42:45.037822 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_exacta_odds, now model.winticket_dbt.silver_race_results)
[0m13:42:45.038595 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m13:42:45.042666 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m13:42:45.043575 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:42:45.044213 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m13:42:45.044961 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from rc
cross join unnest(predictions) as p(pred)
cross join generate_series(1, list_length(pred['order'])) as idx(generate_series)
  );

[0m13:42:45.050589 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:42:45.054159 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m13:42:45.054666 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m13:42:45.055108 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:42:45.055595 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m13:42:45.058460 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:42:45.059048 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:42:45.059632 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: ROLLBACK
[0m13:42:45.060575 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m13:42:45.061612 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m13:42:45.062386 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:42:45.065179 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:42:45.067879 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m13:42:45.068917 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:42:45.070648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69168d5b10>]}
[0m13:42:45.072734 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m13:42:45.074298 [info ] [Thread-2 (]: 5 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.25s]
[0m13:42:45.075579 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m13:42:45.076968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f692e3d0bd0>]}
[0m13:42:45.078013 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m13:42:45.078820 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:42:45.079921 [info ] [Thread-3 (]: 4 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.26s]
[0m13:42:45.082048 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m13:42:45.084588 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m13:42:45.092566 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m13:42:45.095785 [info ] [Thread-2 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m13:42:45.100066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.silver_head_to_head)
[0m13:42:45.101932 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m13:42:45.112451 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m13:42:45.114067 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m13:42:45.125772 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m13:42:45.127588 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:42:45.128547 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m13:42:45.129128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:42:45.130943 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:42:45.132879 [debug] [Thread-1 (]: Failed to rollback 'model.winticket_dbt.silver_tipster_predictions'
[0m13:42:45.133472 [debug] [Thread-4 (]: SQL status: OK in 0.047 seconds
[0m13:42:45.133876 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:42:45.134314 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m13:42:45.137668 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:42:45.138219 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m13:42:45.138850 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m13:42:45.142787 [debug] [Thread-1 (]: Runtime Error in model silver_tipster_predictions (models/silver/silver_tipster_predictions.sql)
  Catalog Error: Scalar Function with name list_length does not exist!
  Did you mean "list_element"?
  
  LINE 21: cross join generate_series(1, list_length(pred['order'])) as idx(generate_series)
                                         ^
[0m13:42:45.143846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6944182310>]}
[0m13:42:45.144876 [error] [Thread-1 (]: 6 of 9 ERROR creating sql view model main_silver.silver_tipster_predictions .... [[31mERROR[0m in 0.29s]
[0m13:42:45.146554 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m13:42:45.147285 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:42:45.149489 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:42:45.150352 [debug] [Thread-7 (]: Marking all children of 'model.winticket_dbt.silver_tipster_predictions' to be skipped because of status 'error'.  Reason: Runtime Error in model silver_tipster_predictions (models/silver/silver_tipster_predictions.sql)
  Catalog Error: Scalar Function with name list_length does not exist!
  Did you mean "list_element"?
  
  LINE 21: cross join generate_series(1, list_length(pred['order'])) as idx(generate_series)
                                         ^.
[0m13:42:45.150953 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:42:45.152439 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:42:45.156085 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:42:45.160599 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:42:45.161391 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m13:42:45.162931 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:42:45.165166 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m13:42:45.166042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f692e3e2110>]}
[0m13:42:45.166858 [info ] [Thread-4 (]: 7 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.13s]
[0m13:42:45.167790 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m13:42:45.196460 [debug] [Thread-2 (]: SQL status: OK in 0.056 seconds
[0m13:42:45.200373 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:42:45.200885 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m13:42:45.201990 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:42:45.203344 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:42:45.203702 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:42:45.203994 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:42:45.207089 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:42:45.209935 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:42:45.210421 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m13:42:45.211358 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:42:45.212836 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m13:42:45.227911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97071689-81af-4d0f-9025-6536a5794156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69168e7650>]}
[0m13:42:45.229625 [info ] [Thread-2 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.13s]
[0m13:42:45.230941 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m13:42:45.232057 [debug] [Thread-3 (]: Began running node model.winticket_dbt.gold_entry_features
[0m13:42:45.232555 [info ] [Thread-3 (]: 9 of 9 SKIP relation main_gold.gold_entry_features ............................. [[33mSKIP[0m]
[0m13:42:45.233296 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m13:42:45.236112 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:45.236596 [debug] [MainThread]: On master: BEGIN
[0m13:42:45.236921 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:42:45.300406 [debug] [MainThread]: SQL status: OK in 0.063 seconds
[0m13:42:45.300891 [debug] [MainThread]: On master: COMMIT
[0m13:42:45.301174 [debug] [MainThread]: Using duckdb connection "master"
[0m13:42:45.301525 [debug] [MainThread]: On master: COMMIT
[0m13:42:45.302212 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:42:45.302601 [debug] [MainThread]: On master: Close
[0m13:42:45.305617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:45.306072 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m13:42:45.306358 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m13:42:45.306587 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_entries' was properly closed.
[0m13:42:45.306806 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_results' was properly closed.
[0m13:42:45.307221 [info ] [MainThread]: 
[0m13:42:45.307815 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m13:42:45.310285 [debug] [MainThread]: Command end result
[0m13:42:45.336114 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:42:45.339080 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:42:45.345428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m13:42:45.345816 [info ] [MainThread]: 
[0m13:42:45.346458 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:42:45.346953 [info ] [MainThread]: 
[0m13:42:45.347556 [error] [MainThread]:   Runtime Error in model silver_tipster_predictions (models/silver/silver_tipster_predictions.sql)
  Catalog Error: Scalar Function with name list_length does not exist!
  Did you mean "list_element"?
  
  LINE 21: cross join generate_series(1, list_length(pred['order'])) as idx(generate_series)
                                         ^
[0m13:42:45.348006 [info ] [MainThread]: 
[0m13:42:45.348528 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=1 TOTAL=9
[0m13:42:45.351186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.3840675, "process_in_blocks": "0", "process_kernel_time": 1.537115, "process_mem_max_rss": "261840", "process_out_blocks": "0", "process_user_time": 5.839953}
[0m13:42:45.351893 [debug] [MainThread]: Command `dbt run` failed at 13:42:45.351775 after 4.39 seconds
[0m13:42:45.352356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694f52fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694b29c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f694af5d350>]}
[0m13:42:45.352712 [debug] [MainThread]: Flushing usage events
[0m13:42:46.322729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:06.832062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960750a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9607761190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9607508190>]}


============================== 13:43:06.842375 | a1efa80f-7472-4e29-ad7b-3d86dcecd991 ==============================
[0m13:43:06.842375 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:43:06.843069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspace/app/winticket_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:07.102483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96075b3e10>]}
[0m13:43:07.159753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9609ee1950>]}
[0m13:43:07.161652 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:43:07.284560 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:43:07.381770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:07.382550 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_tipster_predictions.sql
[0m13:43:07.628336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601793890>]}
[0m13:43:07.684945 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:43:07.687117 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:43:07.707950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9600d58f50>]}
[0m13:43:07.708553 [info ] [MainThread]: Found 9 models, 543 macros
[0m13:43:07.708906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96015a4310>]}
[0m13:43:07.711562 [info ] [MainThread]: 
[0m13:43:07.712169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:43:07.712543 [info ] [MainThread]: 
[0m13:43:07.713193 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:07.718882 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:43:07.719701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:43:07.725667 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:43:07.852360 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:43:07.852898 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:43:07.853229 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:43:07.853589 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:43:07.853992 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:43:07.854365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:07.854680 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:43:07.855034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:07.855565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:08.972370 [debug] [ThreadPool]: SQL status: OK in 1.118 seconds
[0m13:43:08.973117 [debug] [ThreadPool]: SQL status: OK in 1.118 seconds
[0m13:43:08.973512 [debug] [ThreadPool]: SQL status: OK in 1.118 seconds
[0m13:43:08.975061 [debug] [ThreadPool]: On list_winticket: Close
[0m13:43:08.978010 [debug] [ThreadPool]: On list_winticket: Close
[0m13:43:08.980164 [debug] [ThreadPool]: On list_winticket: Close
[0m13:43:08.985091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m13:43:08.985656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m13:43:08.986048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m13:43:08.986692 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m13:43:08.987147 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m13:43:08.987685 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m13:43:08.996336 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:43:08.999004 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:43:09.001844 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:43:09.002406 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:43:09.002783 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:43:09.003138 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:43:09.003539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.003849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.004116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.072069 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m13:43:09.074305 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:43:09.074770 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m13:43:09.075102 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m13:43:09.077782 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:43:09.079407 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m13:43:09.080768 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m13:43:09.081537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:09.084819 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:43:09.086055 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:43:09.087365 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m13:43:09.087874 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:43:09.088851 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m13:43:09.089895 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:43:09.091136 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:43:09.093739 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m13:43:09.096917 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:43:09.095925 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m13:43:09.098085 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m13:43:09.099924 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:43:09.100675 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:43:09.102273 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:43:09.103509 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:43:09.103922 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:43:09.104211 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:43:09.104610 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:43:09.105482 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:43:09.106043 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:43:09.106524 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:43:09.106872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:09.107466 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:43:09.107855 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:09.108225 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m13:43:09.108943 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m13:43:09.109523 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:43:09.111667 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m13:43:09.118952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_bronze)
[0m13:43:09.119663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_silver)
[0m13:43:09.120282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_gold)
[0m13:43:09.127213 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:43:09.129338 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:43:09.131150 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:43:09.131566 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m13:43:09.131923 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m13:43:09.132313 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m13:43:09.132748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.133059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.133401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.197394 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m13:43:09.198966 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:43:09.199639 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m13:43:09.199351 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m13:43:09.200154 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:43:09.200537 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m13:43:09.198371 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m13:43:09.201487 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:43:09.201947 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m13:43:09.220278 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:43:09.221977 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m13:43:09.225880 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m13:43:09.226579 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:43:09.228963 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m13:43:09.229950 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m13:43:09.231150 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m13:43:09.231691 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m13:43:09.232113 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m13:43:09.232650 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m13:43:09.233387 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m13:43:09.233731 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m13:43:09.240049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96015a7450>]}
[0m13:43:09.240887 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:09.241212 [debug] [MainThread]: On master: BEGIN
[0m13:43:09.241492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:09.305458 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m13:43:09.305931 [debug] [MainThread]: On master: COMMIT
[0m13:43:09.306211 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:09.306525 [debug] [MainThread]: On master: COMMIT
[0m13:43:09.307029 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:09.307417 [debug] [MainThread]: On master: Close
[0m13:43:09.312858 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m13:43:09.313482 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m13:43:09.314744 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m13:43:09.316685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.bronze_race_results)
[0m13:43:09.316015 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m13:43:09.317189 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m13:43:09.317693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.bronze_racecards)
[0m13:43:09.327384 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m13:43:09.328283 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m13:43:09.332906 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m13:43:09.333540 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m13:43:09.355541 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m13:43:09.366764 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m13:43:09.370417 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m13:43:09.371213 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:43:09.371630 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m13:43:09.371951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:09.372369 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:43:09.372899 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m13:43:09.373210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:43:09.436566 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m13:43:09.437307 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:43:09.437748 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m13:43:09.438144 [debug] [Thread-2 (]: SQL status: OK in 0.065 seconds
[0m13:43:09.438854 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:43:09.439305 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m13:43:09.488403 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m13:43:09.497479 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:43:09.497995 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m13:43:09.499027 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.502388 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:43:09.502847 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m13:43:09.503551 [debug] [Thread-2 (]: SQL status: OK in 0.064 seconds
[0m13:43:09.506699 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:43:09.507149 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:43:09.507546 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m13:43:09.519655 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:43:09.520617 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:43:09.521070 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:43:09.521435 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.525202 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:43:09.525790 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m13:43:09.527301 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.529306 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:43:09.529728 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:43:09.530189 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:43:09.535594 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:43:09.536077 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:43:09.536571 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m13:43:09.540377 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:43:09.543744 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:43:09.544287 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:43:09.544783 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m13:43:09.547705 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m13:43:09.550793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9600427850>]}
[0m13:43:09.552685 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.23s]
[0m13:43:09.553813 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m13:43:09.554348 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:43:09.556551 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m13:43:09.557633 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m13:43:09.558308 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m13:43:09.560032 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_race_results'
[0m13:43:09.560853 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m13:43:09.566639 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m13:43:09.567474 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m13:43:09.573318 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m13:43:09.574124 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f32b50>]}
[0m13:43:09.575069 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.26s]
[0m13:43:09.576405 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m13:43:09.576905 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:43:09.577746 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m13:43:09.578070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:43:09.579647 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m13:43:09.580089 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m13:43:09.581359 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m13:43:09.580805 [info ] [Thread-1 (]: 4 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m13:43:09.582185 [info ] [Thread-3 (]: 5 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m13:43:09.583354 [info ] [Thread-2 (]: 6 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m13:43:09.584881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_exacta_odds)
[0m13:43:09.586059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.silver_race_entries)
[0m13:43:09.586637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m13:43:09.587146 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m13:43:09.587670 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m13:43:09.588109 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m13:43:09.592074 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.597221 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m13:43:09.603131 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.604112 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m13:43:09.608073 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.608548 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m13:43:09.650317 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m13:43:09.652174 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.656500 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.657226 [debug] [Thread-4 (]: SQL status: OK in 0.079 seconds
[0m13:43:09.662023 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m13:43:09.663586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:09.662690 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:43:09.663144 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.661429 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m13:43:09.664398 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m13:43:09.665132 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m13:43:09.665736 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:43:09.666439 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:43:09.667137 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.668485 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first
from prep
group by 1,2
  );

[0m13:43:09.670571 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:43:09.672110 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.672800 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m13:43:09.671432 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:43:09.673637 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m13:43:09.674233 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:43:09.680382 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:43:09.681126 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:43:09.681845 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m13:43:09.703199 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m13:43:09.707856 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:43:09.708500 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m13:43:09.709641 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.713513 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:43:09.714055 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m13:43:09.715194 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.716965 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:43:09.717454 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:43:09.717834 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:43:09.729395 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m13:43:09.735976 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:43:09.736562 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m13:43:09.740077 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:43:09.742924 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m13:43:09.743510 [debug] [Thread-1 (]: SQL status: OK in 0.074 seconds
[0m13:43:09.744371 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9601604490>]}
[0m13:43:09.748751 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.750478 [debug] [Thread-2 (]: SQL status: OK in 0.077 seconds
[0m13:43:09.749848 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.19s]
[0m13:43:09.751199 [debug] [Thread-3 (]: SQL status: OK in 0.068 seconds
[0m13:43:09.751669 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m13:43:09.755619 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.756499 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m13:43:09.763412 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:43:09.767435 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m13:43:09.765606 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m13:43:09.766499 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:43:09.764776 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m13:43:09.768486 [info ] [Thread-4 (]: 7 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m13:43:09.772130 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.772823 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:43:09.773394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m13:43:09.773858 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m13:43:09.774471 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:43:09.778618 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m13:43:09.778092 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:43:09.784176 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.784961 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:43:09.789848 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:43:09.790774 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m13:43:09.791295 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m13:43:09.793763 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:43:09.795607 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m13:43:09.796601 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:43:09.797137 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.797756 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:43:09.801535 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:43:09.803115 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:43:09.803600 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:43:09.804990 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:43:09.805717 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:43:09.806113 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:43:09.807127 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.809772 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m13:43:09.812020 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:43:09.812999 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:43:09.813952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:43:09.816992 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:43:09.823669 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:43:09.824335 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m13:43:09.824856 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:43:09.825433 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:43:09.825965 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m13:43:09.826849 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:43:09.831143 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:43:09.834027 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:43:09.834842 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from rc
cross join unnest(predictions) as p(pred)
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m13:43:09.835438 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m13:43:09.836238 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m13:43:09.838415 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:43:09.842465 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m13:43:09.845049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f6b0d0>]}
[0m13:43:09.847381 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.26s]
[0m13:43:09.848885 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m13:43:09.850418 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m13:43:09.853334 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m13:43:09.854889 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m13:43:09.858182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0f18a50>]}
[0m13:43:09.863738 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m13:43:09.865155 [info ] [Thread-3 (]: 5 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.27s]
[0m13:43:09.866869 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96002f1a10>]}
[0m13:43:09.867926 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m13:43:09.869191 [info ] [Thread-2 (]: 6 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.28s]
[0m13:43:09.871444 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m13:43:09.872770 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m13:43:09.873937 [info ] [Thread-1 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m13:43:09.875044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_exacta_odds, now model.winticket_dbt.silver_head_to_head)
[0m13:43:09.876073 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m13:43:09.881287 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.881996 [debug] [Thread-4 (]: SQL status: OK in 0.045 seconds
[0m13:43:09.886789 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:43:09.887383 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m13:43:09.887807 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m13:43:09.892822 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.893646 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:43:09.895226 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m13:43:09.895750 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.896140 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:43:09.896653 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m13:43:09.897065 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m13:43:09.897442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:09.898992 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.899488 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.899921 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m13:43:09.901031 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:43:09.905744 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:43:09.906597 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m13:43:09.908101 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.910654 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m13:43:09.911682 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95e0fd2790>]}
[0m13:43:09.912628 [info ] [Thread-4 (]: 7 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.14s]
[0m13:43:09.913724 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m13:43:09.951342 [debug] [Thread-1 (]: SQL status: OK in 0.051 seconds
[0m13:43:09.955448 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.956132 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m13:43:09.957898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.961644 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.962082 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m13:43:09.963198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:43:09.964722 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:43:09.965072 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.965385 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:43:09.977804 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m13:43:09.980532 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:43:09.980904 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m13:43:09.983673 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:43:09.985060 [debug] [Thread-1 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m13:43:10.000687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95d28ad990>]}
[0m13:43:10.001670 [info ] [Thread-1 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.13s]
[0m13:43:10.002719 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m13:43:10.004019 [debug] [Thread-2 (]: Began running node model.winticket_dbt.gold_entry_features
[0m13:43:10.004726 [info ] [Thread-2 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m13:43:10.005539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.gold_entry_features)
[0m13:43:10.006034 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m13:43:10.011415 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m13:43:10.012126 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m13:43:10.033103 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m13:43:10.033947 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:43:10.034333 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m13:43:10.034656 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:43:10.096521 [debug] [Thread-2 (]: SQL status: OK in 0.062 seconds
[0m13:43:10.097084 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:43:10.097606 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.player_id,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.cup_id,
    b.venue_slug,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    p.tipster_id,
    p.tipster_name,
    p.pick_rank,
    r.finish_order,
    case when r.finish_order = 1 then 1 else 0 end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m13:43:11.032164 [debug] [Thread-2 (]: SQL status: OK in 0.934 seconds
[0m13:43:11.035598 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:43:11.036176 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m13:43:11.037876 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.043450 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:43:11.043963 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:43:11.044322 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:43:11.049838 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:43:11.052924 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:43:11.053428 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m13:43:11.054511 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:43:11.056029 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: Close
[0m13:43:11.109841 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1efa80f-7472-4e29-ad7b-3d86dcecd991', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96004817d0>]}
[0m13:43:11.110772 [info ] [Thread-2 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.10s]
[0m13:43:11.111576 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m13:43:11.114273 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:11.114683 [debug] [MainThread]: On master: BEGIN
[0m13:43:11.114953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:11.179884 [debug] [MainThread]: SQL status: OK in 0.065 seconds
[0m13:43:11.180488 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.180790 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:11.181053 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.181795 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:43:11.182155 [debug] [MainThread]: On master: Close
[0m13:43:11.185153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:11.185675 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_entries' was properly closed.
[0m13:43:11.185900 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m13:43:11.186113 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m13:43:11.186364 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m13:43:11.186787 [info ] [MainThread]: 
[0m13:43:11.187115 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m13:43:11.189318 [debug] [MainThread]: Command end result
[0m13:43:11.215839 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:43:11.219767 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:43:11.226326 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m13:43:11.226771 [info ] [MainThread]: 
[0m13:43:11.227321 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:11.227737 [info ] [MainThread]: 
[0m13:43:11.228263 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:43:11.230500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4595995, "process_in_blocks": "0", "process_kernel_time": 1.687775, "process_mem_max_rss": "411152", "process_out_blocks": "0", "process_user_time": 7.935934}
[0m13:43:11.231006 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:11.230891 after 4.46 seconds
[0m13:43:11.231419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9607564b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9600d4b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960bad3dd0>]}
[0m13:43:11.231782 [debug] [MainThread]: Flushing usage events
[0m13:43:12.225644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:42.234503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2366200810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23637f2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2363795c90>]}


============================== 13:45:42.245885 | 76102ddc-4bdb-4006-a98f-b0bfbe5fd87c ==============================
[0m13:45:42.245885 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:45:42.247000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspace/app/winticket_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s gold_entry_features', 'send_anonymous_usage_stats': 'True'}
[0m13:45:42.559298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76102ddc-4bdb-4006-a98f-b0bfbe5fd87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236379c710>]}
[0m13:45:42.618811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76102ddc-4bdb-4006-a98f-b0bfbe5fd87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236621ec10>]}
[0m13:45:42.634410 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:45:42.772903 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:45:42.977439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:42.979124 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/gold/gold_entry_features.sql
[0m13:45:43.260616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76102ddc-4bdb-4006-a98f-b0bfbe5fd87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235dcd4410>]}
[0m13:45:43.322051 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:45:43.324657 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:45:43.356854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76102ddc-4bdb-4006-a98f-b0bfbe5fd87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235d183310>]}
[0m13:45:43.357517 [info ] [MainThread]: Found 9 models, 543 macros
[0m13:45:43.358017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76102ddc-4bdb-4006-a98f-b0bfbe5fd87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2363841290>]}
[0m13:45:43.359731 [info ] [MainThread]: 
[0m13:45:43.360115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:45:43.360493 [info ] [MainThread]: 
[0m13:45:43.361122 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:45:43.362436 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:45:43.497344 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:45:43.497830 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:45:43.498106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:44.679710 [debug] [ThreadPool]: SQL status: OK in 1.181 seconds
[0m13:45:44.681348 [debug] [ThreadPool]: On list_winticket: Close
[0m13:45:44.685528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m13:45:44.686294 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m13:45:44.694944 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:45:44.695565 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:45:44.695927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:44.824901 [debug] [ThreadPool]: SQL status: OK in 0.129 seconds
[0m13:45:44.827537 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:45:44.828027 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m13:45:44.832886 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:45:44.833461 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:45:44.833801 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m13:45:44.834853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:45:44.836343 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:45:44.836793 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:45:44.837100 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:45:44.838015 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:45:44.838413 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m13:45:44.858969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_silver)
[0m13:45:44.860125 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket_main_bronze'
[0m13:45:44.861054 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket_main_gold'
[0m13:45:44.868860 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:45:44.875415 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m13:45:44.874778 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:45:44.871895 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:45:44.875774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:44.876195 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m13:45:44.877451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:44.876665 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m13:45:44.878030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:45.014370 [debug] [ThreadPool]: SQL status: OK in 0.138 seconds
[0m13:45:45.021579 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:45:45.032926 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m13:45:45.036082 [debug] [ThreadPool]: SQL status: OK in 0.158 seconds
[0m13:45:45.040897 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:45:45.041473 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m13:45:45.037790 [debug] [ThreadPool]: SQL status: OK in 0.160 seconds
[0m13:45:45.048477 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:45:45.060525 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m13:45:45.126086 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m13:45:45.130662 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m13:45:45.135932 [debug] [ThreadPool]: SQL status: OK in 0.102 seconds
[0m13:45:45.141464 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m13:45:45.134446 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m13:45:45.146239 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m13:45:45.150525 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m13:45:45.151067 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m13:45:45.154011 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m13:45:45.159445 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m13:45:45.156553 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m13:45:45.162401 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m13:45:45.171165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76102ddc-4bdb-4006-a98f-b0bfbe5fd87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2363796fd0>]}
[0m13:45:45.172938 [debug] [MainThread]: Using duckdb connection "master"
[0m13:45:45.173698 [debug] [MainThread]: On master: BEGIN
[0m13:45:45.174102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:45.305379 [debug] [MainThread]: SQL status: OK in 0.131 seconds
[0m13:45:45.306001 [debug] [MainThread]: On master: COMMIT
[0m13:45:45.306503 [debug] [MainThread]: Using duckdb connection "master"
[0m13:45:45.306888 [debug] [MainThread]: On master: COMMIT
[0m13:45:45.307796 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:45:45.308333 [debug] [MainThread]: On master: Close
[0m13:45:45.316428 [debug] [Thread-1 (]: Began running node model.winticket_dbt.gold_entry_features
[0m13:45:45.317390 [info ] [Thread-1 (]: 1 of 1 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m13:45:45.318168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.gold_entry_features)
[0m13:45:45.318737 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m13:45:45.332214 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m13:45:45.333323 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m13:45:45.377543 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m13:45:45.378639 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:45:45.379199 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m13:45:45.379686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:45.458173 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m13:45:45.458781 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:45:45.459316 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    p.tipster_id,
    p.tipster_name,
    p.pick_rank,
    r.finish_order,
    case when r.finish_order = 1 then 1 else 0 end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m13:45:46.355534 [debug] [Thread-1 (]: SQL status: OK in 0.895 seconds
[0m13:45:46.362333 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:45:46.362802 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m13:45:46.364045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:45:46.367199 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:45:46.367607 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m13:45:46.368738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:45:46.385209 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:45:46.385811 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:45:46.386134 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:45:46.404494 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m13:45:46.411631 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:45:46.412121 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m13:45:46.415759 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:45:46.418762 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: Close
[0m13:45:46.481822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76102ddc-4bdb-4006-a98f-b0bfbe5fd87c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235c76be10>]}
[0m13:45:46.482783 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.16s]
[0m13:45:46.483714 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m13:45:46.488574 [debug] [MainThread]: Using duckdb connection "master"
[0m13:45:46.489084 [debug] [MainThread]: On master: BEGIN
[0m13:45:46.489409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:46.551929 [debug] [MainThread]: SQL status: OK in 0.062 seconds
[0m13:45:46.552601 [debug] [MainThread]: On master: COMMIT
[0m13:45:46.553031 [debug] [MainThread]: Using duckdb connection "master"
[0m13:45:46.553455 [debug] [MainThread]: On master: COMMIT
[0m13:45:46.554437 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:45:46.554839 [debug] [MainThread]: On master: Close
[0m13:45:46.558903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:46.559415 [debug] [MainThread]: Connection 'list_winticket_main_silver' was properly closed.
[0m13:45:46.559647 [debug] [MainThread]: Connection 'list_winticket_main_bronze' was properly closed.
[0m13:45:46.559865 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m13:45:46.560170 [info ] [MainThread]: 
[0m13:45:46.560549 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m13:45:46.561536 [debug] [MainThread]: Command end result
[0m13:45:46.588584 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:45:46.592478 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:45:46.598629 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m13:45:46.599012 [info ] [MainThread]: 
[0m13:45:46.599569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:46.600047 [info ] [MainThread]: 
[0m13:45:46.600550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:45:46.602839 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.430768, "process_in_blocks": "0", "process_kernel_time": 1.75726, "process_mem_max_rss": "378068", "process_out_blocks": "0", "process_user_time": 7.616003}
[0m13:45:46.603427 [debug] [MainThread]: Command `dbt run` succeeded at 13:45:46.603298 after 4.43 seconds
[0m13:45:46.603845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2366200810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23644a2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2367e3c1d0>]}
[0m13:45:46.604237 [debug] [MainThread]: Flushing usage events
[0m13:45:47.434589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:35.462402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd613cdab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd613fc8150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd613cb84d0>]}


============================== 13:48:35.472631 | bbec6635-dc5c-4899-b724-6c450915a519 ==============================
[0m13:48:35.472631 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:48:35.473544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspace/app/winticket_dbt/logs', 'debug': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:48:35.764154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6102ed990>]}
[0m13:48:35.823005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd616660c90>]}
[0m13:48:35.824928 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:48:35.948569 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:48:36.023392 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:48:36.023996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd614a95850>]}
[0m13:48:37.308237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60cd003d0>]}
[0m13:48:37.367485 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:48:37.369736 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:48:37.392994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd614401fd0>]}
[0m13:48:37.393667 [info ] [MainThread]: Found 9 models, 543 macros
[0m13:48:37.394056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd613e208d0>]}
[0m13:48:37.396119 [info ] [MainThread]: 
[0m13:48:37.396554 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:48:37.396904 [info ] [MainThread]: 
[0m13:48:37.397545 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:48:37.404647 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:48:37.405582 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:48:37.417283 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:48:37.471239 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:48:37.471791 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:48:37.472207 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:48:37.472586 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:48:37.472981 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:48:37.473375 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:48:37.473714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:37.474076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:37.474418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:38.826007 [debug] [ThreadPool]: SQL status: OK in 1.352 seconds
[0m13:48:38.826657 [debug] [ThreadPool]: SQL status: OK in 1.353 seconds
[0m13:48:38.827031 [debug] [ThreadPool]: SQL status: OK in 1.353 seconds
[0m13:48:38.828863 [debug] [ThreadPool]: On list_winticket: Close
[0m13:48:38.829984 [debug] [ThreadPool]: On list_winticket: Close
[0m13:48:38.831338 [debug] [ThreadPool]: On list_winticket: Close
[0m13:48:38.836035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m13:48:38.836644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m13:48:38.837006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m13:48:38.837604 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m13:48:38.838077 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m13:48:38.838757 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m13:48:38.846584 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:48:38.849034 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:48:38.851225 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:48:38.851960 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:48:38.852695 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:48:38.853162 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:48:38.853604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:38.853901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:38.854236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:38.921840 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m13:48:38.922567 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m13:48:38.924463 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:48:38.925000 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m13:48:38.925435 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m13:48:38.926757 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:48:38.928370 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:48:38.929509 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m13:48:38.929982 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m13:48:38.930334 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:38.931120 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:48:38.931545 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:48:38.931818 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:38.932185 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:48:38.932542 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m13:48:38.932842 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:48:38.933199 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m13:48:38.933724 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m13:48:38.934195 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:38.935709 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:48:38.936109 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:48:38.936536 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:48:38.936879 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:48:38.937170 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:48:38.938063 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:48:38.938997 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:48:38.939657 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:48:38.940134 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:38.940520 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:48:38.940909 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:48:38.941292 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m13:48:38.941651 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:48:38.943019 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:48:38.943560 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m13:48:38.943866 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:48:38.944702 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m13:48:38.950853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_bronze)
[0m13:48:38.951611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_gold)
[0m13:48:38.952344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_silver)
[0m13:48:38.961050 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:48:38.963791 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:48:38.969129 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:48:38.969869 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m13:48:38.970775 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m13:48:38.971474 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m13:48:38.972071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:38.972628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:38.973093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:48:39.042345 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m13:48:39.043279 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:48:39.043790 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m13:48:39.044364 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m13:48:39.044821 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m13:48:39.045442 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:48:39.045893 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:48:39.046344 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m13:48:39.046771 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m13:48:39.065071 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:48:39.065682 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m13:48:39.066163 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:48:39.067688 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m13:48:39.068975 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m13:48:39.070035 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m13:48:39.070953 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m13:48:39.071439 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m13:48:39.071933 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m13:48:39.072236 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m13:48:39.072605 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m13:48:39.072950 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m13:48:39.079808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60dd8aa10>]}
[0m13:48:39.080577 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:39.080905 [debug] [MainThread]: On master: BEGIN
[0m13:48:39.081176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:48:39.145615 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m13:48:39.146159 [debug] [MainThread]: On master: COMMIT
[0m13:48:39.146524 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:39.146807 [debug] [MainThread]: On master: COMMIT
[0m13:48:39.147460 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:48:39.147781 [debug] [MainThread]: On master: Close
[0m13:48:39.152467 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m13:48:39.153431 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m13:48:39.154870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.bronze_race_results)
[0m13:48:39.155562 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m13:48:39.161709 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m13:48:39.165438 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m13:48:39.166093 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m13:48:39.167299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_racecards)
[0m13:48:39.167776 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m13:48:39.172547 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m13:48:39.173084 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m13:48:39.195548 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m13:48:39.206567 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m13:48:39.210656 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m13:48:39.211721 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:48:39.212101 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:48:39.212497 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m13:48:39.212826 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m13:48:39.213144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:39.213483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:48:39.331339 [debug] [Thread-1 (]: SQL status: OK in 0.118 seconds
[0m13:48:39.332060 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:48:39.332534 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m13:48:39.332943 [debug] [Thread-2 (]: SQL status: OK in 0.119 seconds
[0m13:48:39.333681 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:48:39.334127 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m13:48:39.362182 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m13:48:39.371264 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:48:39.371848 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m13:48:39.373056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:39.376826 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:48:39.377396 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m13:48:39.377844 [debug] [Thread-2 (]: SQL status: OK in 0.043 seconds
[0m13:48:39.381994 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:48:39.382488 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m13:48:39.382889 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:48:39.389213 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:48:39.398573 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:48:39.401621 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:48:39.402155 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m13:48:39.402611 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:48:39.403300 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:48:39.404030 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:48:39.405716 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:48:39.406113 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:48:39.406489 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:48:39.416891 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:48:39.423283 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:48:39.423838 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m13:48:39.424308 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m13:48:39.427959 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:48:39.428856 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m13:48:39.431360 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m13:48:39.434877 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m13:48:39.435399 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:48:39.438460 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m13:48:39.439016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60e1d4890>]}
[0m13:48:39.439818 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.28s]
[0m13:48:39.441017 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m13:48:39.441884 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m13:48:39.442532 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m13:48:39.443971 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_race_results'
[0m13:48:39.444588 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m13:48:39.452850 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m13:48:39.456086 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m13:48:39.470337 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m13:48:39.471218 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60c142f90>]}
[0m13:48:39.472221 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.30s]
[0m13:48:39.473074 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m13:48:39.474014 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:48:39.474770 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m13:48:39.475185 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:48:39.476572 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m13:48:39.477114 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m13:48:39.479087 [info ] [Thread-1 (]: 4 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m13:48:39.481681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_exacta_odds)
[0m13:48:39.482149 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m13:48:39.479910 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m13:48:39.480689 [info ] [Thread-3 (]: 5 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m13:48:39.493020 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.silver_race_entries)
[0m13:48:39.490699 [info ] [Thread-2 (]: 6 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m13:48:39.495584 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m13:48:39.499863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m13:48:39.488790 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.506132 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m13:48:39.508238 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m13:48:39.512349 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.512947 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m13:48:39.517665 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.565446 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m13:48:39.566345 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m13:48:39.572607 [debug] [Thread-4 (]: SQL status: OK in 0.097 seconds
[0m13:48:39.573155 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.573701 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.577188 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m13:48:39.579102 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:48:39.580047 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m13:48:39.580745 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.581344 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m13:48:39.581848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:48:39.582302 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:48:39.582709 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m13:48:39.583958 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m13:48:39.585033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:48:39.586019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:48:39.589173 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:48:39.591325 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.590146 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:48:39.592447 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m13:48:39.593606 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.594590 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:48:39.599007 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:48:39.598056 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first
from prep
group by 1,2
  );

[0m13:48:39.599878 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m13:48:39.647876 [debug] [Thread-4 (]: SQL status: OK in 0.065 seconds
[0m13:48:39.657047 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:48:39.657781 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m13:48:39.658230 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m13:48:39.659143 [debug] [Thread-3 (]: SQL status: OK in 0.057 seconds
[0m13:48:39.664024 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.667986 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:48:39.668583 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m13:48:39.669077 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:48:39.669489 [debug] [Thread-1 (]: SQL status: OK in 0.069 seconds
[0m13:48:39.669876 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m13:48:39.673369 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:48:39.676536 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.677198 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:48:39.678079 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m13:48:39.678872 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m13:48:39.682348 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.682782 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:48:39.683900 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m13:48:39.684540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:39.687781 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:48:39.688209 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:48:39.693176 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.694349 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m13:48:39.695330 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:48:39.697202 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:48:39.697744 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m13:48:39.699887 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:48:39.700466 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:48:39.700864 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:48:39.701650 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.702180 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:48:39.702658 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:48:39.704532 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:48:39.705147 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:48:39.707086 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:48:39.708096 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:48:39.709626 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.710480 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:48:39.711370 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:48:39.714152 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:48:39.720980 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:48:39.721839 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m13:48:39.722406 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m13:48:39.722959 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:48:39.723467 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m13:48:39.727151 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:48:39.731859 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:48:39.734535 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:48:39.735460 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m13:48:39.736169 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m13:48:39.736882 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m13:48:39.738694 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:48:39.741109 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m13:48:39.741886 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:48:39.742969 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d052e310>]}
[0m13:48:39.745110 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m13:48:39.745648 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:48:39.746153 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:48:39.747010 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.30s]
[0m13:48:39.748035 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ec160b50>]}
[0m13:48:39.749858 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m13:48:39.751211 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m13:48:39.751923 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m13:48:39.752747 [info ] [Thread-2 (]: 6 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.25s]
[0m13:48:39.753916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ec193a90>]}
[0m13:48:39.754615 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m13:48:39.755398 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m13:48:39.756271 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.27s]
[0m13:48:39.757343 [info ] [Thread-4 (]: 7 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m13:48:39.759327 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m13:48:39.761982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m13:48:39.764021 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m13:48:39.774773 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.778064 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m13:48:39.788467 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.792296 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60c10b150>]}
[0m13:48:39.793809 [info ] [Thread-3 (]: 5 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.30s]
[0m13:48:39.794916 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m13:48:39.796446 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.797067 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m13:48:39.797550 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m13:48:39.798773 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:48:39.798144 [info ] [Thread-2 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m13:48:39.799761 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.silver_head_to_head)
[0m13:48:39.800196 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m13:48:39.804404 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m13:48:39.805090 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m13:48:39.808850 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m13:48:39.809632 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:48:39.810166 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m13:48:39.810953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:48:39.867920 [debug] [Thread-4 (]: SQL status: OK in 0.069 seconds
[0m13:48:39.868613 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.869369 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
),
filtered as (
    select
        race_id,
        pred
    from rc
    cross join unnest(predictions) as p(pred)
    where pred['tipsterId']::varchar = 'dsc-00'
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from filtered
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m13:48:39.870164 [debug] [Thread-2 (]: SQL status: OK in 0.059 seconds
[0m13:48:39.870658 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:48:39.871147 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m13:48:39.897513 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m13:48:39.901883 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.902488 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions" rename to "silver_tipster_predictions__dbt_backup"
[0m13:48:39.903692 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:48:39.907413 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.907905 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m13:48:39.909025 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:48:39.910766 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m13:48:39.911225 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.911634 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m13:48:39.917312 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:48:39.922666 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:48:39.923181 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m13:48:39.924804 [debug] [Thread-2 (]: SQL status: OK in 0.053 seconds
[0m13:48:40.005025 [debug] [Thread-4 (]: SQL status: OK in 0.081 seconds
[0m13:48:40.006980 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:48:40.008549 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m13:48:40.008998 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m13:48:40.009996 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5d05738d0>]}
[0m13:48:40.010857 [info ] [Thread-4 (]: 7 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.25s]
[0m13:48:40.011448 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:48:40.012192 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m13:48:40.015450 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:48:40.016146 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m13:48:40.017309 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.018712 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:48:40.019060 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:48:40.019369 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:48:40.022657 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:48:40.025563 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:48:40.025934 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m13:48:40.029144 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:48:40.031024 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m13:48:40.050932 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60c2ab010>]}
[0m13:48:40.053616 [info ] [Thread-2 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.25s]
[0m13:48:40.056682 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m13:48:40.058731 [debug] [Thread-3 (]: Began running node model.winticket_dbt.gold_entry_features
[0m13:48:40.060982 [info ] [Thread-3 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m13:48:40.062627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_entries, now model.winticket_dbt.gold_entry_features)
[0m13:48:40.064185 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m13:48:40.071509 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m13:48:40.072289 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m13:48:40.091666 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m13:48:40.092613 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:48:40.092978 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m13:48:40.093343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:48:40.160426 [debug] [Thread-3 (]: SQL status: OK in 0.067 seconds
[0m13:48:40.161058 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:48:40.161641 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case when r.finish_order = 1 then 1 else 0 end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m13:48:40.952757 [debug] [Thread-3 (]: SQL status: OK in 0.790 seconds
[0m13:48:40.957533 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:48:40.957972 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m13:48:40.959147 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.962388 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:48:40.962791 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m13:48:40.963812 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:48:40.970738 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:48:40.971345 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:48:40.971698 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:48:40.977512 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:48:40.981339 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:48:40.981903 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m13:48:40.985896 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:48:40.987776 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: Close
[0m13:48:41.066514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbec6635-dc5c-4899-b724-6c450915a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60c285050>]}
[0m13:48:41.067861 [info ] [Thread-3 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.00s]
[0m13:48:41.068920 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m13:48:41.071459 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:41.071948 [debug] [MainThread]: On master: BEGIN
[0m13:48:41.072297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:48:41.154675 [debug] [MainThread]: SQL status: OK in 0.082 seconds
[0m13:48:41.155444 [debug] [MainThread]: On master: COMMIT
[0m13:48:41.155987 [debug] [MainThread]: Using duckdb connection "master"
[0m13:48:41.156481 [debug] [MainThread]: On master: COMMIT
[0m13:48:41.157585 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:48:41.158126 [debug] [MainThread]: On master: Close
[0m13:48:41.168886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:41.169643 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_exacta_odds' was properly closed.
[0m13:48:41.170149 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m13:48:41.170632 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m13:48:41.171079 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m13:48:41.172363 [info ] [MainThread]: 
[0m13:48:41.172980 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m13:48:41.178040 [debug] [MainThread]: Command end result
[0m13:48:41.216608 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:48:41.220767 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:48:41.232968 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m13:48:41.234377 [info ] [MainThread]: 
[0m13:48:41.235119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:41.236345 [info ] [MainThread]: 
[0m13:48:41.237197 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:48:41.239796 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8321676, "process_in_blocks": "0", "process_kernel_time": 1.702227, "process_mem_max_rss": "392916", "process_out_blocks": "0", "process_user_time": 9.173761}
[0m13:48:41.240841 [debug] [MainThread]: Command `dbt run` succeeded at 13:48:41.240642 after 5.83 seconds
[0m13:48:41.241492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd613fdd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60dfb6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61824fbd0>]}
[0m13:48:41.242407 [debug] [MainThread]: Flushing usage events
[0m13:48:42.213961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:28.767754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf564850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf566a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf564810>]}


============================== 13:55:28.778331 | 5946708e-35ae-4db2-9c96-1768716474df ==============================
[0m13:55:28.778331 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:55:28.778986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspace/app/winticket_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:55:29.060876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf5c47d0>]}
[0m13:55:29.139227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fd1f27250>]}
[0m13:55:29.142408 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:55:29.370691 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:55:29.502479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:29.503270 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/gold/gold_entry_features.sql
[0m13:55:29.746086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc99afed0>]}
[0m13:55:29.806492 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:55:29.812620 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:55:29.845591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc8d042d0>]}
[0m13:55:29.846167 [info ] [MainThread]: Found 9 models, 543 macros
[0m13:55:29.846721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc8eda2d0>]}
[0m13:55:29.848761 [info ] [MainThread]: 
[0m13:55:29.849263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:29.849572 [info ] [MainThread]: 
[0m13:55:29.850126 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:55:29.855912 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:55:29.856760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:55:29.873964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:55:30.028133 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:55:30.028707 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:55:30.029018 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:55:30.029361 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:55:30.029742 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:55:30.030056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:30.030416 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:55:30.030740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:30.031205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:31.447323 [debug] [ThreadPool]: SQL status: OK in 1.417 seconds
[0m13:55:31.447926 [debug] [ThreadPool]: SQL status: OK in 1.417 seconds
[0m13:55:31.448349 [debug] [ThreadPool]: SQL status: OK in 1.418 seconds
[0m13:55:31.449888 [debug] [ThreadPool]: On list_winticket: Close
[0m13:55:31.451535 [debug] [ThreadPool]: On list_winticket: Close
[0m13:55:31.452683 [debug] [ThreadPool]: On list_winticket: Close
[0m13:55:31.457921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m13:55:31.458611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m13:55:31.459048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m13:55:31.459622 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m13:55:31.460167 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m13:55:31.460755 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m13:55:31.469675 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:55:31.474500 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:55:31.477288 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:55:31.477798 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:55:31.478203 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:55:31.478619 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:55:31.478977 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:31.479332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:31.479669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:31.545111 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m13:55:31.545688 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m13:55:31.546115 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m13:55:31.547683 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:55:31.549113 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:55:31.550497 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:55:31.550905 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m13:55:31.551368 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m13:55:31.551730 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m13:55:31.552815 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:31.553187 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:31.553526 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:55:31.553833 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:31.554186 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:55:31.554566 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m13:55:31.554925 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:55:31.555269 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m13:55:31.555873 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m13:55:31.556508 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:31.557663 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:55:31.558122 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m13:55:31.558562 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:55:31.558941 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:55:31.559275 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m13:55:31.560099 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:55:31.560928 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:55:31.561607 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:55:31.562067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:31.562505 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m13:55:31.562874 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:55:31.563192 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m13:55:31.563557 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m13:55:31.564613 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:31.565173 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m13:55:31.565764 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:55:31.566145 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m13:55:31.573648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_silver)
[0m13:55:31.574349 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_bronze)
[0m13:55:31.574969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_gold)
[0m13:55:31.582654 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:55:31.584701 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:55:31.586505 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:55:31.586896 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m13:55:31.587229 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m13:55:31.587614 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m13:55:31.587975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:31.588462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:31.588812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:31.652234 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m13:55:31.652868 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m13:55:31.653299 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:55:31.653748 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m13:55:31.654098 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:55:31.654490 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m13:55:31.654834 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:55:31.655229 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m13:55:31.655939 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m13:55:31.678670 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m13:55:31.679412 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:55:31.679860 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:55:31.681402 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m13:55:31.682615 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m13:55:31.684078 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m13:55:31.685854 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m13:55:31.686233 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m13:55:31.686732 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m13:55:31.687090 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m13:55:31.687439 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m13:55:31.687735 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m13:55:31.694418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc8141fd0>]}
[0m13:55:31.695282 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:31.695623 [debug] [MainThread]: On master: BEGIN
[0m13:55:31.695907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:31.763040 [debug] [MainThread]: SQL status: OK in 0.067 seconds
[0m13:55:31.765178 [debug] [MainThread]: On master: COMMIT
[0m13:55:31.766996 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:31.768008 [debug] [MainThread]: On master: COMMIT
[0m13:55:31.771054 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:55:31.772127 [debug] [MainThread]: On master: Close
[0m13:55:31.787925 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m13:55:31.790056 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m13:55:31.792522 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m13:55:31.794885 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m13:55:31.797274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_race_results)
[0m13:55:31.799348 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.bronze_racecards)
[0m13:55:31.801319 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m13:55:31.802951 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m13:55:31.829722 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m13:55:31.831471 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m13:55:31.832335 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m13:55:31.832707 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m13:55:31.893928 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m13:55:31.896613 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m13:55:31.899939 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:55:31.901066 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:55:31.902606 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m13:55:31.903852 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m13:55:31.904662 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:31.905332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:32.006178 [debug] [Thread-2 (]: SQL status: OK in 0.101 seconds
[0m13:55:32.007144 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:55:32.007581 [debug] [Thread-1 (]: SQL status: OK in 0.102 seconds
[0m13:55:32.008070 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m13:55:32.008648 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:55:32.009447 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m13:55:32.071773 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m13:55:32.081141 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:55:32.081907 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m13:55:32.082984 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m13:55:32.086747 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:55:32.087264 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:55:32.087645 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m13:55:32.090593 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:55:32.091534 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m13:55:32.092401 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:32.095678 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:55:32.096114 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:55:32.096567 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m13:55:32.107876 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:55:32.108742 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:55:32.109267 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:55:32.109739 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m13:55:32.111142 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:55:32.112503 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:55:32.113004 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m13:55:32.117418 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:55:32.123615 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m13:55:32.124119 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m13:55:32.124556 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m13:55:32.128657 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m13:55:32.129293 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m13:55:32.132101 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:55:32.135766 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m13:55:32.136232 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:55:32.139443 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m13:55:32.140328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc8d80910>]}
[0m13:55:32.141220 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.34s]
[0m13:55:32.142695 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m13:55:32.143925 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m13:55:32.144658 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m13:55:32.145182 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m13:55:32.145872 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m13:55:32.146856 [info ] [Thread-3 (]: 4 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m13:55:32.149560 [info ] [Thread-2 (]: 5 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m13:55:32.154830 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_exacta_odds'
[0m13:55:32.159021 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m13:55:32.160137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.silver_race_entries)
[0m13:55:32.165853 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m13:55:32.166876 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m13:55:32.167547 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m13:55:32.171464 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.172126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc8100590>]}
[0m13:55:32.175643 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.179311 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m13:55:32.180302 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.38s]
[0m13:55:32.183938 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m13:55:32.181988 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m13:55:32.183170 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m13:55:32.181086 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m13:55:32.184390 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m13:55:32.190671 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.195303 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m13:55:32.199162 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.200081 [info ] [Thread-1 (]: 6 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m13:55:32.201540 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.202208 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:55:32.202990 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.203753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m13:55:32.204272 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m13:55:32.204780 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m13:55:32.205215 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m13:55:32.205743 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m13:55:32.206193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:32.206700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:32.207117 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:55:32.212080 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.213207 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m13:55:32.219457 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.220315 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.220667 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m13:55:32.220967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:32.277896 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m13:55:32.278886 [debug] [Thread-3 (]: SQL status: OK in 0.072 seconds
[0m13:55:32.279334 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.280297 [debug] [Thread-4 (]: SQL status: OK in 0.073 seconds
[0m13:55:32.280912 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:55:32.281400 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m13:55:32.281775 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m13:55:32.282295 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.284059 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.286006 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
),
filtered as (
    select
        race_id,
        pred
    from rc
    cross join unnest(predictions) as p(pred)
    where pred['tipsterId']::varchar = 'dsc-00'
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from filtered
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m13:55:32.285237 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first
from prep
group by 1,2
  );

[0m13:55:32.282793 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m13:55:32.363559 [debug] [Thread-2 (]: SQL status: OK in 0.079 seconds
[0m13:55:32.372183 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.372825 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m13:55:32.377199 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:55:32.384831 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.386884 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m13:55:32.388194 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:55:32.393203 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:55:32.393803 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.394163 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m13:55:32.402543 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:55:32.407079 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m13:55:32.407633 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m13:55:32.412132 [debug] [Thread-3 (]: SQL status: OK in 0.117 seconds
[0m13:55:32.420606 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m13:55:32.421939 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:55:32.423671 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m13:55:32.424178 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m13:55:32.425033 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc82cc050>]}
[0m13:55:32.426345 [info ] [Thread-2 (]: 5 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.27s]
[0m13:55:32.427750 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m13:55:32.428327 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_results
[0m13:55:32.428871 [info ] [Thread-2 (]: 7 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m13:55:32.429455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.silver_race_results)
[0m13:55:32.429833 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m13:55:32.435664 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m13:55:32.436349 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:55:32.440868 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:55:32.441548 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_results
[0m13:55:32.441999 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m13:55:32.442493 [debug] [Thread-1 (]: SQL status: OK in 0.156 seconds
[0m13:55:32.445991 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m13:55:32.450476 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.453572 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:55:32.454296 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m13:55:32.454865 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions" rename to "silver_tipster_predictions__dbt_backup"
[0m13:55:32.455353 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m13:55:32.456083 [debug] [Thread-4 (]: SQL status: OK in 0.168 seconds
[0m13:55:32.457658 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:55:32.458399 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:32.461847 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.462292 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:55:32.462760 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:55:32.463590 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m13:55:32.467178 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.467932 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m13:55:32.468793 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m13:55:32.469383 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m13:55:32.469781 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:55:32.470488 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:55:32.475184 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.475961 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m13:55:32.476546 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m13:55:32.476989 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m13:55:32.477468 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m13:55:32.489863 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m13:55:32.500366 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.498987 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:55:32.501230 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m13:55:32.504621 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:55:32.506097 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.493123 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m13:55:32.509394 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m13:55:32.506802 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m13:55:32.519079 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:55:32.527831 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m13:55:32.528529 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m13:55:32.529794 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m13:55:32.531612 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m13:55:32.535798 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc81cb610>]}
[0m13:55:32.532063 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m13:55:32.535035 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m13:55:32.536500 [info ] [Thread-3 (]: 4 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.38s]
[0m13:55:32.543022 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m13:55:32.541768 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:55:32.542373 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m13:55:32.529022 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m13:55:32.543719 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m13:55:32.544109 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m13:55:32.545684 [info ] [Thread-3 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m13:55:32.546294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_entries, now model.winticket_dbt.silver_head_to_head)
[0m13:55:32.546906 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m13:55:32.551946 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.552904 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m13:55:32.553369 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:55:32.553767 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m13:55:32.557511 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:55:32.558057 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m13:55:32.560696 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m13:55:32.562324 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m13:55:32.562811 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m13:55:32.566569 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.567473 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc8d6d750>]}
[0m13:55:32.567989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc811cd10>]}
[0m13:55:32.569490 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.42s]
[0m13:55:32.570379 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:55:32.570955 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.574757 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m13:55:32.572579 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m13:55:32.574205 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:55:32.571675 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.36s]
[0m13:55:32.575487 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:32.576164 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:55:32.576864 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m13:55:32.577775 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m13:55:32.578906 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:55:32.579556 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.580205 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m13:55:32.581502 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:55:32.587642 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m13:55:32.592887 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m13:55:32.600703 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m13:55:32.603732 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_results: Close
[0m13:55:32.604910 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fc8d20b10>]}
[0m13:55:32.606084 [info ] [Thread-2 (]: 7 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.18s]
[0m13:55:32.607296 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_results
[0m13:55:32.667732 [debug] [Thread-3 (]: SQL status: OK in 0.087 seconds
[0m13:55:32.671820 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.672376 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m13:55:32.673741 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:55:32.678061 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.678971 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m13:55:32.683445 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:55:32.685338 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:55:32.685893 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.686394 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m13:55:32.689825 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:55:32.693180 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m13:55:32.693842 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m13:55:32.696768 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:55:32.698336 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m13:55:32.718153 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa8fd1fd0>]}
[0m13:55:32.719531 [info ] [Thread-3 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.17s]
[0m13:55:32.720856 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m13:55:32.722644 [debug] [Thread-4 (]: Began running node model.winticket_dbt.gold_entry_features
[0m13:55:32.723603 [info ] [Thread-4 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m13:55:32.724308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_exacta_odds, now model.winticket_dbt.gold_entry_features)
[0m13:55:32.724802 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m13:55:32.731059 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m13:55:32.731918 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m13:55:32.752347 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m13:55:32.753420 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:55:32.753850 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m13:55:32.754206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:55:32.820079 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m13:55:32.820697 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:55:32.821268 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case
        when r.finish_order = 1 then 1
        when r.finish_order is null then null
        else 0
    end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m13:55:33.967758 [debug] [Thread-4 (]: SQL status: OK in 1.146 seconds
[0m13:55:33.972783 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:55:33.973229 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m13:55:33.974502 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:55:33.977588 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:55:33.977955 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m13:55:33.978965 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:55:33.983733 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:55:33.984138 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:55:33.984463 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:55:33.997321 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m13:55:34.000335 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:55:34.000730 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m13:55:34.005416 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:55:34.007101 [debug] [Thread-4 (]: On model.winticket_dbt.gold_entry_features: Close
[0m13:55:34.077178 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5946708e-35ae-4db2-9c96-1768716474df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fa80a8cd0>]}
[0m13:55:34.078027 [info ] [Thread-4 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.35s]
[0m13:55:34.078971 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m13:55:34.080984 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:34.081437 [debug] [MainThread]: On master: BEGIN
[0m13:55:34.081713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:34.145856 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m13:55:34.146408 [debug] [MainThread]: On master: COMMIT
[0m13:55:34.146717 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:34.146984 [debug] [MainThread]: On master: COMMIT
[0m13:55:34.147557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:55:34.147887 [debug] [MainThread]: On master: Close
[0m13:55:34.151933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:34.152417 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m13:55:34.152652 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_results' was properly closed.
[0m13:55:34.152868 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m13:55:34.153080 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m13:55:34.153619 [info ] [MainThread]: 
[0m13:55:34.154094 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m13:55:34.156158 [debug] [MainThread]: Command end result
[0m13:55:34.181404 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:55:34.185467 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:55:34.191868 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m13:55:34.192400 [info ] [MainThread]: 
[0m13:55:34.192917 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:34.193362 [info ] [MainThread]: 
[0m13:55:34.193812 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:55:34.196798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.487187, "process_in_blocks": "0", "process_kernel_time": 2.044568, "process_mem_max_rss": "479036", "process_out_blocks": "0", "process_user_time": 9.464339}
[0m13:55:34.197388 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:34.197228 after 5.49 seconds
[0m13:55:34.197829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf5bb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf5bbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9fcf7bda50>]}
[0m13:55:34.198195 [debug] [MainThread]: Flushing usage events
[0m13:55:35.294840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:54.244970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78eb161910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78eb3b9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78eb15bc10>]}


============================== 13:56:54.257944 | 5b409e47-e7a4-4b2b-adc2-c4adad02b35a ==============================
[0m13:56:54.257944 [info ] [MainThread]: Running with dbt=1.9.1
[0m13:56:54.261743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspace/app/winticket_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s gold_entry_features', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:54.558862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b409e47-e7a4-4b2b-adc2-c4adad02b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78eb163650>]}
[0m13:56:54.616558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b409e47-e7a4-4b2b-adc2-c4adad02b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78edb20f50>]}
[0m13:56:54.623877 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m13:56:54.759846 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m13:56:54.912384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:56:54.913554 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/gold/gold_entry_features.sql
[0m13:56:55.213741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b409e47-e7a4-4b2b-adc2-c4adad02b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78e55c8610>]}
[0m13:56:55.273524 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:56:55.275761 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:56:55.310546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b409e47-e7a4-4b2b-adc2-c4adad02b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78e4945b90>]}
[0m13:56:55.311145 [info ] [MainThread]: Found 9 models, 543 macros
[0m13:56:55.311673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b409e47-e7a4-4b2b-adc2-c4adad02b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78e4972bd0>]}
[0m13:56:55.313307 [info ] [MainThread]: 
[0m13:56:55.313700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:55.314014 [info ] [MainThread]: 
[0m13:56:55.314616 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:55.315763 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m13:56:55.451782 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m13:56:55.452235 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m13:56:55.452550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:56.918152 [debug] [ThreadPool]: SQL status: OK in 1.465 seconds
[0m13:56:56.920081 [debug] [ThreadPool]: On list_winticket: Close
[0m13:56:56.924500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m13:56:56.925150 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m13:56:56.932428 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:56:56.932853 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m13:56:56.933143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:56.998215 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m13:56:56.999931 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:56:57.000266 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m13:56:57.000906 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:57.001232 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:56:57.001516 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m13:56:57.002116 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:57.003133 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:56:57.003525 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m13:56:57.003784 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m13:56:57.004494 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:56:57.004872 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m13:56:57.013502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_silver)
[0m13:56:57.014446 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket_main_bronze'
[0m13:56:57.022060 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket_main_gold'
[0m13:56:57.024450 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:56:57.027596 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:56:57.031808 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:56:57.032514 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m13:56:57.032943 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m13:56:57.033376 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m13:56:57.033785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:57.034286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:57.034741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:57.102034 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m13:56:57.102621 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m13:56:57.103468 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m13:56:57.103925 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m13:56:57.104785 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m13:56:57.105282 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m13:56:57.105662 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m13:56:57.106376 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m13:56:57.106740 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m13:56:57.127232 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m13:56:57.127799 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m13:56:57.129610 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m13:56:57.130808 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m13:56:57.131374 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m13:56:57.132959 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m13:56:57.134236 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m13:56:57.134790 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m13:56:57.135115 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m13:56:57.135605 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m13:56:57.135927 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m13:56:57.136916 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m13:56:57.142509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b409e47-e7a4-4b2b-adc2-c4adad02b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78e490c190>]}
[0m13:56:57.143202 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:57.143554 [debug] [MainThread]: On master: BEGIN
[0m13:56:57.143830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:57.208293 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m13:56:57.208765 [debug] [MainThread]: On master: COMMIT
[0m13:56:57.209038 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:57.209328 [debug] [MainThread]: On master: COMMIT
[0m13:56:57.209843 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:56:57.210196 [debug] [MainThread]: On master: Close
[0m13:56:57.214794 [debug] [Thread-1 (]: Began running node model.winticket_dbt.gold_entry_features
[0m13:56:57.215559 [info ] [Thread-1 (]: 1 of 1 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m13:56:57.216280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.gold_entry_features)
[0m13:56:57.216702 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m13:56:57.228832 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m13:56:57.229742 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m13:56:57.263357 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m13:56:57.264288 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:56:57.264664 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m13:56:57.264974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:57.329758 [debug] [Thread-1 (]: SQL status: OK in 0.065 seconds
[0m13:56:57.330330 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:56:57.330804 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.player_name,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case
        when r.finish_order = 1 then 1
        when r.finish_order is null then null
        else 0
    end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m13:56:58.577820 [debug] [Thread-1 (]: SQL status: OK in 1.246 seconds
[0m13:56:58.584382 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:56:58.584828 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m13:56:58.586043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:58.590426 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:56:58.591069 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m13:56:58.592527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:56:58.608287 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:56:58.608897 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:56:58.609269 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m13:56:58.637576 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m13:56:58.643716 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m13:56:58.644203 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m13:56:58.648527 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:56:58.651679 [debug] [Thread-1 (]: On model.winticket_dbt.gold_entry_features: Close
[0m13:56:58.727803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b409e47-e7a4-4b2b-adc2-c4adad02b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78e5429b10>]}
[0m13:56:58.729113 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.51s]
[0m13:56:58.730102 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m13:56:58.732820 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:58.733497 [debug] [MainThread]: On master: BEGIN
[0m13:56:58.733991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:58.826454 [debug] [MainThread]: SQL status: OK in 0.092 seconds
[0m13:56:58.827126 [debug] [MainThread]: On master: COMMIT
[0m13:56:58.827662 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:58.828056 [debug] [MainThread]: On master: COMMIT
[0m13:56:58.829655 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:56:58.830409 [debug] [MainThread]: On master: Close
[0m13:56:58.837085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:58.840231 [debug] [MainThread]: Connection 'list_winticket_main_silver' was properly closed.
[0m13:56:58.840797 [debug] [MainThread]: Connection 'list_winticket_main_bronze' was properly closed.
[0m13:56:58.841218 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m13:56:58.842729 [info ] [MainThread]: 
[0m13:56:58.843544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m13:56:58.845122 [debug] [MainThread]: Command end result
[0m13:56:58.939435 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m13:56:58.945552 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m13:56:58.952032 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m13:56:58.952477 [info ] [MainThread]: 
[0m13:56:58.953006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:58.953423 [info ] [MainThread]: 
[0m13:56:58.953818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:56:58.956815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7727494, "process_in_blocks": "0", "process_kernel_time": 1.949875, "process_mem_max_rss": "460892", "process_out_blocks": "0", "process_user_time": 7.752157}
[0m13:56:58.957411 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:58.957285 after 4.77 seconds
[0m13:56:58.957812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ef70fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ef789110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ef788f90>]}
[0m13:56:58.958193 [debug] [MainThread]: Flushing usage events
[0m13:56:59.827832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:46.148339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35cebfcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35cebfd050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35cebff050>]}


============================== 14:05:46.159964 | 07dfda48-0ba2-4a9c-b74b-d6f9ec692139 ==============================
[0m14:05:46.159964 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:05:46.160732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspace/app/winticket_dbt/logs', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:46.434293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35cec52f50>]}
[0m14:05:46.492876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d15bf4d0>]}
[0m14:05:46.495638 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:05:46.633831 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:05:46.781888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:46.782417 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:46.813469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35cec98990>]}
[0m14:05:46.874539 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:05:46.876544 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:05:46.916828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c8ffb690>]}
[0m14:05:46.917594 [info ] [MainThread]: Found 9 models, 543 macros
[0m14:05:46.918124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ceabda10>]}
[0m14:05:46.920816 [info ] [MainThread]: 
[0m14:05:46.921283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:46.921730 [info ] [MainThread]: 
[0m14:05:46.922621 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:05:46.930217 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:05:46.932765 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:05:46.939059 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:05:47.009780 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:05:47.010235 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:05:47.010652 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:05:47.011005 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:05:47.011346 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:05:47.011716 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:05:47.012051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:47.012389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:47.012733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:48.213921 [debug] [ThreadPool]: SQL status: OK in 1.202 seconds
[0m14:05:48.214471 [debug] [ThreadPool]: SQL status: OK in 1.202 seconds
[0m14:05:48.214937 [debug] [ThreadPool]: SQL status: OK in 1.202 seconds
[0m14:05:48.216742 [debug] [ThreadPool]: On list_winticket: Close
[0m14:05:48.218068 [debug] [ThreadPool]: On list_winticket: Close
[0m14:05:48.219395 [debug] [ThreadPool]: On list_winticket: Close
[0m14:05:48.225531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m14:05:48.226058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m14:05:48.226553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m14:05:48.227482 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m14:05:48.228202 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m14:05:48.228811 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m14:05:48.241566 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:05:48.245326 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:05:48.248781 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:05:48.249649 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:05:48.250157 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:05:48.250700 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:05:48.251161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.251644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.252154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.348505 [debug] [ThreadPool]: SQL status: OK in 0.097 seconds
[0m14:05:48.349312 [debug] [ThreadPool]: SQL status: OK in 0.098 seconds
[0m14:05:48.351480 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:05:48.352095 [debug] [ThreadPool]: SQL status: OK in 0.100 seconds
[0m14:05:48.353319 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:05:48.353651 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m14:05:48.354919 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:05:48.355294 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m14:05:48.355884 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m14:05:48.356520 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:05:48.357114 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:05:48.357642 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:05:48.357926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:05:48.358301 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:05:48.358668 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m14:05:48.358973 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:05:48.359339 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m14:05:48.359864 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m14:05:48.360323 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:05:48.361728 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:05:48.362098 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:05:48.362499 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:05:48.362785 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:05:48.363834 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:05:48.364235 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:05:48.364997 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:05:48.365417 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:05:48.365994 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:05:48.366404 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:05:48.366780 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:05:48.367051 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:05:48.367575 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m14:05:48.368086 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:05:48.369475 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m14:05:48.370230 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:05:48.371860 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m14:05:48.377906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_gold)
[0m14:05:48.378650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_silver)
[0m14:05:48.379221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_bronze)
[0m14:05:48.386377 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:05:48.388517 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:05:48.390448 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:05:48.390850 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m14:05:48.391209 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m14:05:48.391571 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m14:05:48.391925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.392295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.392631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:48.459533 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m14:05:48.460465 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m14:05:48.460833 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:05:48.461347 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:05:48.461758 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m14:05:48.462091 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m14:05:48.462487 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m14:05:48.463343 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:05:48.464158 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m14:05:48.482667 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:05:48.484915 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m14:05:48.485391 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m14:05:48.485886 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m14:05:48.487473 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m14:05:48.489023 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m14:05:48.493615 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m14:05:48.495009 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m14:05:48.495577 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m14:05:48.497464 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m14:05:48.498040 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m14:05:48.498728 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m14:05:48.513306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ceb07e50>]}
[0m14:05:48.515810 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.517747 [debug] [MainThread]: On master: BEGIN
[0m14:05:48.518304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:48.584275 [debug] [MainThread]: SQL status: OK in 0.066 seconds
[0m14:05:48.584783 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.585091 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:48.585412 [debug] [MainThread]: On master: COMMIT
[0m14:05:48.585958 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:05:48.586377 [debug] [MainThread]: On master: Close
[0m14:05:48.591048 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m14:05:48.591622 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m14:05:48.592296 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m14:05:48.592861 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m14:05:48.593650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.bronze_race_results)
[0m14:05:48.594128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_racecards)
[0m14:05:48.594569 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m14:05:48.594951 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m14:05:48.603869 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m14:05:48.608574 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m14:05:48.609579 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m14:05:48.623450 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m14:05:48.718873 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m14:05:48.720530 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m14:05:48.721368 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:05:48.721818 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:05:48.722167 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m14:05:48.722572 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m14:05:48.722964 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:48.723377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:48.788989 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m14:05:48.789776 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:05:48.790280 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m14:05:48.790695 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m14:05:48.791382 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:05:48.791832 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m14:05:48.851001 [debug] [Thread-2 (]: SQL status: OK in 0.060 seconds
[0m14:05:48.858721 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:05:48.859240 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m14:05:48.860557 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:05:48.864533 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:05:48.865165 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m14:05:48.866424 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:05:48.881963 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:05:48.882756 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:05:48.883275 [debug] [Thread-1 (]: SQL status: OK in 0.091 seconds
[0m14:05:48.883725 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:05:48.887099 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:05:48.887915 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m14:05:48.889004 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:05:48.892575 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:05:48.893066 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m14:05:48.893499 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:05:48.899261 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:05:48.899777 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:05:48.900262 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m14:05:48.901828 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:05:48.902602 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:05:48.903001 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:05:48.905113 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:05:48.908855 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m14:05:48.910789 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:05:48.914794 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:05:48.915501 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m14:05:48.915989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35cec40950>]}
[0m14:05:48.917238 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.32s]
[0m14:05:48.918173 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m14:05:48.919483 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m14:05:48.919981 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m14:05:48.920481 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m14:05:48.920939 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:05:48.921558 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m14:05:48.922395 [info ] [Thread-3 (]: 4 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m14:05:48.923105 [info ] [Thread-2 (]: 5 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m14:05:48.925061 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m14:05:48.925766 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_exacta_odds'
[0m14:05:48.926269 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.silver_race_entries)
[0m14:05:48.926724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m14:05:48.927308 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m14:05:48.928212 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m14:05:48.928823 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m14:05:48.935535 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m14:05:48.944142 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m14:05:48.951792 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m14:05:48.952769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c8b166d0>]}
[0m14:05:48.953758 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m14:05:48.954208 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m14:05:48.955102 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.36s]
[0m14:05:48.964420 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m14:05:48.959857 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m14:05:48.963309 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m14:05:48.965819 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m14:05:48.955803 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m14:05:48.967053 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:05:48.967897 [info ] [Thread-1 (]: 6 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m14:05:48.973729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m14:05:48.972599 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:05:48.973063 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m14:05:48.974155 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m14:05:48.972068 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m14:05:48.974620 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m14:05:48.975011 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:48.979025 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:48.979848 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:05:48.980665 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:05:48.982051 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m14:05:48.983580 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m14:05:48.988696 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:48.989322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:48.990411 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:48.990910 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m14:05:48.991283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:49.053625 [debug] [Thread-4 (]: SQL status: OK in 0.078 seconds
[0m14:05:49.054654 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:05:49.055507 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first
from prep
group by 1,2
  );

[0m14:05:49.055971 [debug] [Thread-3 (]: SQL status: OK in 0.076 seconds
[0m14:05:49.057986 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:05:49.058796 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m14:05:49.056490 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m14:05:49.057530 [debug] [Thread-1 (]: SQL status: OK in 0.066 seconds
[0m14:05:49.061440 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:49.061950 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
),
filtered as (
    select
        race_id,
        pred
    from rc
    cross join unnest(predictions) as p(pred)
    where pred['tipsterId']::varchar = 'dsc-00'
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from filtered
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m14:05:49.060857 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:05:49.063721 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m14:05:49.156611 [debug] [Thread-4 (]: SQL status: OK in 0.099 seconds
[0m14:05:49.161005 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:05:49.161637 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m14:05:49.162966 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.167048 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:05:49.167649 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m14:05:49.168738 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.170544 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:05:49.171088 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:05:49.171568 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:05:49.172604 [debug] [Thread-3 (]: SQL status: OK in 0.113 seconds
[0m14:05:49.178711 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:05:49.179370 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m14:05:49.179837 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m14:05:49.184341 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.187742 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:05:49.192997 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m14:05:49.192319 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:05:49.194372 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m14:05:49.195539 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.199195 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:05:49.199940 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:05:49.200395 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:05:49.200832 [debug] [Thread-2 (]: SQL status: OK in 0.136 seconds
[0m14:05:49.202510 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m14:05:49.202975 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:05:49.206653 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:05:49.208334 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m14:05:49.207544 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c8d74810>]}
[0m14:05:49.210466 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.209627 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.28s]
[0m14:05:49.214629 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:05:49.215626 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m14:05:49.216332 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m14:05:49.217122 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m14:05:49.218058 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m14:05:49.221724 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:05:49.224229 [info ] [Thread-4 (]: 7 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m14:05:49.227800 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:05:49.228272 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m14:05:49.228930 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_exacta_odds, now model.winticket_dbt.silver_race_results)
[0m14:05:49.230966 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:05:49.231854 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m14:05:49.232755 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:05:49.233182 [debug] [Thread-1 (]: SQL status: OK in 0.171 seconds
[0m14:05:49.237021 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m14:05:49.237986 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:05:49.238711 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:05:49.243017 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:49.245540 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m14:05:49.246346 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m14:05:49.249898 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions" rename to "silver_tipster_predictions__dbt_backup"
[0m14:05:49.251744 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c800a7d0>]}
[0m14:05:49.255676 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m14:05:49.256150 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:05:49.257276 [info ] [Thread-3 (]: 4 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.33s]
[0m14:05:49.258188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.261225 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:05:49.261781 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:05:49.262426 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m14:05:49.267084 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:49.267709 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m14:05:49.268146 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m14:05:49.268962 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m14:05:49.269432 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m14:05:49.270119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:05:49.271159 [info ] [Thread-3 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m14:05:49.273535 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:05:49.274118 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:05:49.274879 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_entries, now model.winticket_dbt.silver_head_to_head)
[0m14:05:49.275458 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:05:49.279107 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:05:49.280955 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m14:05:49.281545 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m14:05:49.282196 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:05:49.283078 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:49.284763 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c80ba990>]}
[0m14:05:49.289415 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.290006 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m14:05:49.290474 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:05:49.291186 [info ] [Thread-2 (]: 5 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.36s]
[0m14:05:49.297802 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m14:05:49.292830 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m14:05:49.307426 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:05:49.313697 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:05:49.317686 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m14:05:49.316568 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.320646 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.326417 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m14:05:49.327634 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:05:49.328475 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:05:49.331859 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m14:05:49.334492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c808cd50>]}
[0m14:05:49.333440 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:05:49.336294 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.336862 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m14:05:49.335501 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.36s]
[0m14:05:49.342042 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m14:05:49.351773 [debug] [Thread-4 (]: SQL status: OK in 0.059 seconds
[0m14:05:49.356035 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:05:49.356603 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m14:05:49.357731 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.361416 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:05:49.361940 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m14:05:49.363377 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.366940 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:05:49.367583 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:05:49.368041 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:05:49.372003 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:05:49.375486 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:05:49.376020 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m14:05:49.379532 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:05:49.381846 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m14:05:49.383330 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35cec14110>]}
[0m14:05:49.384414 [info ] [Thread-4 (]: 7 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.15s]
[0m14:05:49.385102 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m14:05:49.415341 [debug] [Thread-3 (]: SQL status: OK in 0.078 seconds
[0m14:05:49.419673 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.420138 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m14:05:49.421360 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.424333 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.424711 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m14:05:49.425671 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:05:49.427031 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:05:49.427400 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.427695 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:05:49.431613 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:05:49.435302 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:05:49.435776 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m14:05:49.438898 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:05:49.440442 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m14:05:49.462654 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c8b25910>]}
[0m14:05:49.463764 [info ] [Thread-3 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.19s]
[0m14:05:49.464813 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m14:05:49.465819 [debug] [Thread-2 (]: Began running node model.winticket_dbt.gold_entry_features
[0m14:05:49.466485 [info ] [Thread-2 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m14:05:49.467281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.gold_entry_features)
[0m14:05:49.467736 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m14:05:49.473692 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m14:05:49.474411 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m14:05:49.497735 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m14:05:49.498956 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:05:49.499427 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m14:05:49.499768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:49.561333 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m14:05:49.561849 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:05:49.562355 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.player_name,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case
        when r.finish_order = 1 then 1
        when r.finish_order is null then null
        else 0
    end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m14:05:51.188564 [debug] [Thread-2 (]: SQL status: OK in 1.625 seconds
[0m14:05:51.193736 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:05:51.194297 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m14:05:51.195601 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:05:51.199756 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:05:51.200344 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m14:05:51.201633 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:05:51.207304 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:05:51.207798 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:05:51.208106 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:05:51.214825 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:05:51.217832 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:05:51.218264 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m14:05:51.222000 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:05:51.224919 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: Close
[0m14:05:51.337079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07dfda48-0ba2-4a9c-b74b-d6f9ec692139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c8063590>]}
[0m14:05:51.338497 [info ] [Thread-2 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.87s]
[0m14:05:51.339806 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m14:05:51.342021 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:51.343072 [debug] [MainThread]: On master: BEGIN
[0m14:05:51.343629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:51.409167 [debug] [MainThread]: SQL status: OK in 0.066 seconds
[0m14:05:51.409699 [debug] [MainThread]: On master: COMMIT
[0m14:05:51.410009 [debug] [MainThread]: Using duckdb connection "master"
[0m14:05:51.410326 [debug] [MainThread]: On master: COMMIT
[0m14:05:51.411034 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:05:51.411458 [debug] [MainThread]: On master: Close
[0m14:05:51.415799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:51.416327 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m14:05:51.416570 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m14:05:51.416793 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m14:05:51.417011 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_results' was properly closed.
[0m14:05:51.417442 [info ] [MainThread]: 
[0m14:05:51.417792 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m14:05:51.420012 [debug] [MainThread]: Command end result
[0m14:05:51.462055 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:05:51.468825 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:05:51.482858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m14:05:51.483763 [info ] [MainThread]: 
[0m14:05:51.484685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:51.485574 [info ] [MainThread]: 
[0m14:05:51.486710 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:05:51.494677 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.400764, "process_in_blocks": "0", "process_kernel_time": 2.610623, "process_mem_max_rss": "452720", "process_out_blocks": "0", "process_user_time": 10.834667}
[0m14:05:51.496766 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:51.496498 after 5.40 seconds
[0m14:05:51.506493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d336d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d31abbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35d31ab990>]}
[0m14:05:51.509316 [debug] [MainThread]: Flushing usage events
[0m14:05:52.592374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:57.066318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db9420850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db96794d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db941bcd0>]}


============================== 14:08:57.079618 | 1ef34f85-40cf-441e-9e23-9dab485813ce ==============================
[0m14:08:57.079618 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:08:57.080225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspace/app/winticket_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:57.490946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db943b390>]}
[0m14:08:57.549979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbbde31d0>]}
[0m14:08:57.553710 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:08:57.686536 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:08:57.893118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:57.893698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:57.921767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db59146d0>]}
[0m14:08:57.982812 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:08:57.985082 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:08:58.033844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db35ae7d0>]}
[0m14:08:58.034466 [info ] [MainThread]: Found 9 models, 543 macros
[0m14:08:58.034825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db3603990>]}
[0m14:08:58.036925 [info ] [MainThread]: 
[0m14:08:58.037362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:08:58.037950 [info ] [MainThread]: 
[0m14:08:58.038814 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:08:58.044418 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:08:58.045404 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:08:58.051509 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:08:58.158014 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:08:58.158614 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:08:58.159006 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:08:58.159448 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:08:58.159850 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:08:58.160228 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:08:58.160621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:58.161034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:58.161428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:59.350886 [debug] [ThreadPool]: SQL status: OK in 1.190 seconds
[0m14:08:59.351528 [debug] [ThreadPool]: SQL status: OK in 1.190 seconds
[0m14:08:59.352046 [debug] [ThreadPool]: SQL status: OK in 1.191 seconds
[0m14:08:59.353686 [debug] [ThreadPool]: On list_winticket: Close
[0m14:08:59.355077 [debug] [ThreadPool]: On list_winticket: Close
[0m14:08:59.357340 [debug] [ThreadPool]: On list_winticket: Close
[0m14:08:59.361962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m14:08:59.362530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m14:08:59.362971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m14:08:59.363554 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m14:08:59.363986 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m14:08:59.364457 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m14:08:59.372495 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:08:59.375621 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:08:59.377907 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:08:59.378397 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:08:59.378762 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:08:59.379204 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:08:59.379597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:59.379944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:59.380301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:59.460083 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m14:08:59.461404 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m14:08:59.463764 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:08:59.464519 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m14:08:59.464835 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m14:08:59.466039 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:08:59.467617 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:08:59.468038 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m14:08:59.468480 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:08:59.468790 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m14:08:59.469372 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:08:59.469786 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:59.470373 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m14:08:59.470892 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:08:59.471213 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:59.471949 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m14:08:59.472403 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:08:59.472685 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:59.473271 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m14:08:59.474438 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:08:59.474784 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:08:59.475384 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:08:59.476473 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:08:59.476801 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:08:59.477122 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:08:59.477515 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:08:59.478350 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:08:59.478927 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:08:59.479419 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:08:59.479702 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:59.480324 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:08:59.480813 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m14:08:59.481174 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:59.482417 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:08:59.482743 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m14:08:59.483087 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m14:08:59.489421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_bronze)
[0m14:08:59.490130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_gold)
[0m14:08:59.491199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_silver)
[0m14:08:59.498882 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:08:59.501227 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:08:59.503352 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:08:59.503781 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m14:08:59.504114 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m14:08:59.504504 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m14:08:59.504992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:59.505461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:59.506185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:59.575608 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m14:08:59.576171 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:08:59.576970 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m14:08:59.577369 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m14:08:59.578126 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m14:08:59.578626 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:08:59.579018 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:08:59.579414 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m14:08:59.579797 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m14:08:59.598131 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:08:59.598920 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:08:59.599288 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m14:08:59.600679 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m14:08:59.602093 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m14:08:59.603174 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m14:08:59.604425 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m14:08:59.605226 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m14:08:59.605715 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m14:08:59.606048 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m14:08:59.606373 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m14:08:59.606669 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m14:08:59.613764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db113ea10>]}
[0m14:08:59.614528 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:59.614825 [debug] [MainThread]: On master: BEGIN
[0m14:08:59.615061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:59.679192 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m14:08:59.679769 [debug] [MainThread]: On master: COMMIT
[0m14:08:59.680057 [debug] [MainThread]: Using duckdb connection "master"
[0m14:08:59.680347 [debug] [MainThread]: On master: COMMIT
[0m14:08:59.680910 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:08:59.681298 [debug] [MainThread]: On master: Close
[0m14:08:59.686061 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m14:08:59.686605 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m14:08:59.687294 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m14:08:59.687982 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m14:08:59.688792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.bronze_race_results)
[0m14:08:59.689279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_racecards)
[0m14:08:59.689760 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m14:08:59.690158 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m14:08:59.700183 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m14:08:59.704428 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m14:08:59.705572 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m14:08:59.719980 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m14:08:59.817320 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m14:08:59.817818 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m14:08:59.818813 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:08:59.819272 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:08:59.819599 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m14:08:59.819977 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m14:08:59.820385 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:59.820834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:59.887152 [debug] [Thread-2 (]: SQL status: OK in 0.067 seconds
[0m14:08:59.887969 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:08:59.888471 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m14:08:59.888882 [debug] [Thread-1 (]: SQL status: OK in 0.068 seconds
[0m14:08:59.889690 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:08:59.890166 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m14:08:59.950207 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m14:08:59.958723 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:08:59.959366 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m14:08:59.960622 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:08:59.964929 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:08:59.965692 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m14:08:59.966966 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:08:59.980861 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:08:59.981474 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:08:59.981839 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:08:59.984302 [debug] [Thread-1 (]: SQL status: OK in 0.093 seconds
[0m14:08:59.988231 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:08:59.988877 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m14:08:59.989324 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m14:08:59.995631 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:08:59.996189 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:08:59.996691 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m14:08:59.999963 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:09:00.000740 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m14:09:00.001756 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:09:00.003713 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:09:00.004154 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:09:00.004663 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:09:00.007969 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m14:09:00.008585 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:09:00.010847 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db3603850>]}
[0m14:09:00.011970 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.32s]
[0m14:09:00.012897 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m14:09:00.014103 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:09:00.017142 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:09:00.017633 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m14:09:00.018093 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m14:09:00.018668 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m14:09:00.019199 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m14:09:00.019819 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m14:09:00.020891 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_exacta_odds'
[0m14:09:00.021855 [info ] [Thread-3 (]: 4 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m14:09:00.022688 [info ] [Thread-2 (]: 5 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m14:09:00.023574 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m14:09:00.024296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.silver_race_entries)
[0m14:09:00.024794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m14:09:00.025187 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:09:00.030193 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.031222 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m14:09:00.031742 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m14:09:00.033474 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m14:09:00.039437 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m14:09:00.040561 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m14:09:00.048975 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m14:09:00.048056 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.055870 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.054533 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m14:09:00.043809 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.056348 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m14:09:00.057285 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:09:00.058020 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m14:09:00.058606 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:09:00.059114 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m14:09:00.065459 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:00.068048 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.069657 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.070011 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m14:09:00.068803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db3603390>]}
[0m14:09:00.070353 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:00.071133 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.38s]
[0m14:09:00.073865 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m14:09:00.075326 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m14:09:00.076769 [info ] [Thread-1 (]: 6 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m14:09:00.079841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m14:09:00.080528 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m14:09:00.088628 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.089899 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m14:09:00.094420 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.095283 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.095674 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m14:09:00.096012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:00.148973 [debug] [Thread-4 (]: SQL status: OK in 0.090 seconds
[0m14:09:00.149968 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.150417 [debug] [Thread-3 (]: SQL status: OK in 0.085 seconds
[0m14:09:00.150924 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first
from prep
group by 1,2
  );

[0m14:09:00.151396 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:09:00.152703 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m14:09:00.154369 [debug] [Thread-1 (]: SQL status: OK in 0.058 seconds
[0m14:09:00.160769 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.161500 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
),
filtered as (
    select
        race_id,
        pred
    from rc
    cross join unnest(predictions) as p(pred)
    where pred['tipsterId']::varchar = 'dsc-00'
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from filtered
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m14:09:00.155335 [debug] [Thread-2 (]: SQL status: OK in 0.085 seconds
[0m14:09:00.163887 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.164610 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m14:09:00.254130 [debug] [Thread-4 (]: SQL status: OK in 0.102 seconds
[0m14:09:00.264468 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.265179 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m14:09:00.269822 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.279470 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.280173 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m14:09:00.281034 [debug] [Thread-2 (]: SQL status: OK in 0.116 seconds
[0m14:09:00.286945 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.288184 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m14:09:00.288734 [debug] [Thread-1 (]: SQL status: OK in 0.127 seconds
[0m14:09:00.289326 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:09:00.296896 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:09:00.294716 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.298979 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions" rename to "silver_tipster_predictions__dbt_backup"
[0m14:09:00.298464 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.297593 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:09:00.299760 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:09:00.303544 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.305174 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m14:09:00.306582 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.304498 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:09:00.308805 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:09:00.312851 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.313385 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:09:00.313919 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.314396 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m14:09:00.317164 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:09:00.317840 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:09:00.318905 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m14:09:00.321728 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:09:00.323735 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:09:00.324413 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:09:00.325517 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.329208 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:09:00.334144 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:09:00.334772 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:09:00.335237 [debug] [Thread-3 (]: SQL status: OK in 0.178 seconds
[0m14:09:00.336763 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m14:09:00.337224 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m14:09:00.342832 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:09:00.343604 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:09:00.344370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db1061bd0>]}
[0m14:09:00.345126 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m14:09:00.348553 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:09:00.349055 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:09:00.349828 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.32s]
[0m14:09:00.350893 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m14:09:00.352617 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m14:09:00.353376 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m14:09:00.353774 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:09:00.354987 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db36c7790>]}
[0m14:09:00.355697 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m14:09:00.359748 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:09:00.360997 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:09:00.362481 [info ] [Thread-2 (]: 5 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.33s]
[0m14:09:00.364145 [info ] [Thread-4 (]: 7 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m14:09:00.364937 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m14:09:00.366627 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m14:09:00.367266 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m14:09:00.367811 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_exacta_odds, now model.winticket_dbt.silver_race_results)
[0m14:09:00.369621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db35aebd0>]}
[0m14:09:00.370164 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m14:09:00.371078 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.29s]
[0m14:09:00.371981 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:09:00.375574 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m14:09:00.376395 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m14:09:00.377948 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:09:00.378871 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:09:00.379278 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m14:09:00.379724 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:09:00.384994 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m14:09:00.386097 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:09:00.386595 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m14:09:00.386984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:09:00.388505 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.389019 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:09:00.389541 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m14:09:00.390352 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:09:00.394558 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:09:00.395375 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m14:09:00.399937 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:09:00.401995 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m14:09:00.402827 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db10c8610>]}
[0m14:09:00.403719 [info ] [Thread-3 (]: 4 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.38s]
[0m14:09:00.404740 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m14:09:00.407317 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m14:09:00.408209 [info ] [Thread-2 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m14:09:00.408968 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.silver_head_to_head)
[0m14:09:00.409621 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m14:09:00.414990 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.415837 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m14:09:00.420351 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.421862 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.422445 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m14:09:00.422853 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:09:00.424185 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.424704 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.425156 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m14:09:00.430753 [debug] [Thread-4 (]: SQL status: OK in 0.041 seconds
[0m14:09:00.435600 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:09:00.436344 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m14:09:00.437621 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.441511 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:09:00.442080 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m14:09:00.443261 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.445033 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:09:00.445546 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:09:00.445932 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:09:00.449118 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:09:00.453173 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:09:00.453851 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m14:09:00.457010 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:09:00.459155 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m14:09:00.460011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db10c0210>]}
[0m14:09:00.461428 [info ] [Thread-4 (]: 7 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.09s]
[0m14:09:00.462713 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m14:09:00.519747 [debug] [Thread-2 (]: SQL status: OK in 0.094 seconds
[0m14:09:00.523579 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.524013 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m14:09:00.525161 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.529052 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.529588 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m14:09:00.530705 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:09:00.532164 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:09:00.532549 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.532847 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:09:00.536201 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:09:00.539521 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:09:00.540141 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m14:09:00.543286 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:09:00.544862 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m14:09:00.566918 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db10c8910>]}
[0m14:09:00.567921 [info ] [Thread-2 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.16s]
[0m14:09:00.569018 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m14:09:00.570075 [debug] [Thread-3 (]: Began running node model.winticket_dbt.gold_entry_features
[0m14:09:00.570666 [info ] [Thread-3 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m14:09:00.571490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_entries, now model.winticket_dbt.gold_entry_features)
[0m14:09:00.571968 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m14:09:00.578280 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m14:09:00.579066 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m14:09:00.601210 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m14:09:00.602139 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:09:00.602521 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m14:09:00.602825 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:09:00.667217 [debug] [Thread-3 (]: SQL status: OK in 0.064 seconds
[0m14:09:00.668011 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:09:00.668862 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.player_name,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case
        when r.finish_order = 1 then 1
        when r.finish_order is null then null
        else 0
    end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m14:09:01.966318 [debug] [Thread-3 (]: SQL status: OK in 1.296 seconds
[0m14:09:01.970508 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:09:01.971004 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m14:09:01.972294 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:09:01.975454 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:09:01.975854 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m14:09:01.976889 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:09:01.982905 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:09:01.983744 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:09:01.984209 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:09:01.992046 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:09:01.995331 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:09:01.995771 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m14:09:01.999290 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:09:02.001004 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: Close
[0m14:09:02.067161 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ef34f85-40cf-441e-9e23-9dab485813ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db95b8410>]}
[0m14:09:02.068060 [info ] [Thread-3 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.50s]
[0m14:09:02.068870 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m14:09:02.071206 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:02.071685 [debug] [MainThread]: On master: BEGIN
[0m14:09:02.071962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:02.135787 [debug] [MainThread]: SQL status: OK in 0.064 seconds
[0m14:09:02.136392 [debug] [MainThread]: On master: COMMIT
[0m14:09:02.136720 [debug] [MainThread]: Using duckdb connection "master"
[0m14:09:02.137001 [debug] [MainThread]: On master: COMMIT
[0m14:09:02.137902 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:09:02.138336 [debug] [MainThread]: On master: Close
[0m14:09:02.142367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:02.142906 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m14:09:02.143192 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m14:09:02.143472 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m14:09:02.143692 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_results' was properly closed.
[0m14:09:02.144107 [info ] [MainThread]: 
[0m14:09:02.144580 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m14:09:02.146775 [debug] [MainThread]: Command end result
[0m14:09:02.172214 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:09:02.177181 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:09:02.184949 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m14:09:02.185499 [info ] [MainThread]: 
[0m14:09:02.186024 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:02.186655 [info ] [MainThread]: 
[0m14:09:02.187276 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:09:02.190118 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.183466, "process_in_blocks": "0", "process_kernel_time": 2.37244, "process_mem_max_rss": "555196", "process_out_blocks": "0", "process_user_time": 10.491836}
[0m14:09:02.190780 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:02.190644 after 5.18 seconds
[0m14:09:02.191200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbd9cfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbd9cfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbda48f10>]}
[0m14:09:02.191615 [debug] [MainThread]: Flushing usage events
[0m14:09:03.209172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:28.319287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe726d2a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe726d2ae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe726d28850>]}


============================== 14:26:28.332448 | 88a9e8f4-50ff-4d0b-9e74-471c04a907b4 ==============================
[0m14:26:28.332448 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:26:28.333073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspace/app/winticket_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:26:28.675986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe726d21910>]}
[0m14:26:28.734160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe72978e590>]}
[0m14:26:28.745198 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:26:28.901789 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:26:29.074179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:29.074696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:29.103628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe720798bd0>]}
[0m14:26:29.172465 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:26:29.175824 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:26:29.229694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe720799810>]}
[0m14:26:29.230404 [info ] [MainThread]: Found 9 models, 543 macros
[0m14:26:29.231049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7210db090>]}
[0m14:26:29.233614 [info ] [MainThread]: 
[0m14:26:29.234022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:26:29.234572 [info ] [MainThread]: 
[0m14:26:29.235370 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:26:29.241413 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:26:29.242748 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:26:29.253967 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:26:29.341758 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:26:29.342901 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:26:29.343418 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:26:29.343975 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:26:29.344391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:29.344754 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:26:29.345125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:29.346109 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:26:29.347750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:31.106851 [debug] [ThreadPool]: SQL status: OK in 1.762 seconds
[0m14:26:31.110994 [debug] [ThreadPool]: On list_winticket: Close
[0m14:26:31.112774 [debug] [ThreadPool]: SQL status: OK in 1.765 seconds
[0m14:26:31.114475 [debug] [ThreadPool]: SQL status: OK in 1.769 seconds
[0m14:26:31.118042 [debug] [ThreadPool]: On list_winticket: Close
[0m14:26:31.120921 [debug] [ThreadPool]: On list_winticket: Close
[0m14:26:31.139905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m14:26:31.141371 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m14:26:31.149377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m14:26:31.155583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m14:26:31.159372 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:26:31.160286 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m14:26:31.160882 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m14:26:31.161342 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:26:31.163999 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:26:31.166429 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:26:31.166994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:31.167403 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:26:31.167811 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:26:31.168499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:31.168928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:31.249969 [debug] [ThreadPool]: SQL status: OK in 0.083 seconds
[0m14:26:31.250621 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m14:26:31.251114 [debug] [ThreadPool]: SQL status: OK in 0.082 seconds
[0m14:26:31.252763 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:26:31.254138 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:26:31.255482 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:26:31.255827 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m14:26:31.256232 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m14:26:31.256643 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m14:26:31.257606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:26:31.258002 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:26:31.258546 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:26:31.258914 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:26:31.259202 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:26:31.259615 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m14:26:31.260020 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m14:26:31.260379 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:26:31.261231 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m14:26:31.261804 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:26:31.262824 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:26:31.263145 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:26:31.263464 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:26:31.263826 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:26:31.264615 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:26:31.265393 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:26:31.265758 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:26:31.266056 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:26:31.266395 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:26:31.266971 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:26:31.267487 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:26:31.267982 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:26:31.268504 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:26:31.268962 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m14:26:31.269281 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:26:31.269605 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m14:26:31.270307 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m14:26:31.277237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_gold)
[0m14:26:31.278045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_bronze)
[0m14:26:31.279217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_silver)
[0m14:26:31.286280 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:26:31.288394 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:26:31.290820 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:26:31.291544 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m14:26:31.292231 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m14:26:31.292664 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m14:26:31.293023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:31.293362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:31.293663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:26:31.370822 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m14:26:31.371361 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m14:26:31.372952 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:26:31.373712 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:26:31.374219 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m14:26:31.374772 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m14:26:31.375157 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m14:26:31.376033 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:26:31.376761 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m14:26:31.401173 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:26:31.402753 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m14:26:31.404966 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m14:26:31.405491 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m14:26:31.407423 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m14:26:31.408978 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m14:26:31.410696 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m14:26:31.412000 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m14:26:31.412761 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m14:26:31.413222 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m14:26:31.413944 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m14:26:31.414472 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m14:26:31.428645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe726d4fa10>]}
[0m14:26:31.431072 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:31.431850 [debug] [MainThread]: On master: BEGIN
[0m14:26:31.432356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:31.545482 [debug] [MainThread]: SQL status: OK in 0.113 seconds
[0m14:26:31.546634 [debug] [MainThread]: On master: COMMIT
[0m14:26:31.549774 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:31.550347 [debug] [MainThread]: On master: COMMIT
[0m14:26:31.551288 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:26:31.551691 [debug] [MainThread]: On master: Close
[0m14:26:31.559188 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m14:26:31.559979 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m14:26:31.562260 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m14:26:31.564145 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m14:26:31.564973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_race_results)
[0m14:26:31.565582 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.bronze_racecards)
[0m14:26:31.566658 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m14:26:31.566126 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m14:26:31.579181 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m14:26:31.585529 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m14:26:31.586738 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m14:26:31.592817 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m14:26:31.861215 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m14:26:31.862029 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m14:26:31.863360 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:26:31.864022 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m14:26:31.865109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:31.864665 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:26:31.865992 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m14:26:31.866456 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:31.962367 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m14:26:31.963198 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:26:31.963922 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m14:26:31.964492 [debug] [Thread-2 (]: SQL status: OK in 0.098 seconds
[0m14:26:31.965430 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:26:31.965981 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m14:26:32.143608 [debug] [Thread-1 (]: SQL status: OK in 0.178 seconds
[0m14:26:32.165567 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:26:32.166881 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m14:26:32.169385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.173819 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:26:32.174725 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m14:26:32.179882 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:26:32.193506 [debug] [Thread-2 (]: SQL status: OK in 0.227 seconds
[0m14:26:32.197841 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:26:32.198500 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m14:26:32.212286 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:26:32.213045 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:26:32.213568 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:26:32.213915 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:26:32.217577 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:26:32.218081 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m14:26:32.219181 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.220869 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:26:32.222267 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:26:32.224225 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:26:32.230527 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:26:32.237450 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:26:32.238054 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m14:26:32.238617 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m14:26:32.242088 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:26:32.243179 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m14:26:32.246277 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:26:32.249486 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m14:26:32.249972 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:26:32.253092 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m14:26:32.254509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe726d2bb50>]}
[0m14:26:32.255599 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.69s]
[0m14:26:32.256619 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m14:26:32.258842 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m14:26:32.259929 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m14:26:32.262074 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_race_results'
[0m14:26:32.262776 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m14:26:32.267711 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m14:26:32.268731 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m14:26:32.276546 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m14:26:32.277471 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:26:32.278013 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m14:26:32.278492 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:26:32.282700 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe72065bed0>]}
[0m14:26:32.284123 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.72s]
[0m14:26:32.285009 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m14:26:32.286861 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m14:26:32.289423 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m14:26:32.290576 [info ] [Thread-1 (]: 4 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m14:26:32.294329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_exacta_odds)
[0m14:26:32.296957 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m14:26:32.293102 [info ] [Thread-3 (]: 5 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m14:26:32.302959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.silver_race_entries)
[0m14:26:32.303427 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m14:26:32.292002 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m14:26:32.301730 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.310566 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m14:26:32.308340 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m14:26:32.309385 [info ] [Thread-2 (]: 6 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m14:26:32.315774 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.382812 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m14:26:32.384162 [debug] [Thread-4 (]: SQL status: OK in 0.106 seconds
[0m14:26:32.385149 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m14:26:32.390998 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m14:26:32.391949 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:26:32.392744 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.394063 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m14:26:32.395149 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m14:26:32.396155 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m14:26:32.402335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:32.401108 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.403860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.404475 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.404931 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first
from prep
group by 1,2
  );

[0m14:26:32.396970 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:26:32.406744 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m14:26:32.407358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:26:32.408836 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.409792 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:26:32.415519 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m14:26:32.419501 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m14:26:32.424376 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.425392 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.426011 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m14:26:32.426513 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:32.431356 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:26:32.431960 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.432697 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m14:26:32.514117 [debug] [Thread-1 (]: SQL status: OK in 0.109 seconds
[0m14:26:32.519142 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.519866 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m14:26:32.521083 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.526197 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.526998 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m14:26:32.529712 [debug] [Thread-4 (]: SQL status: OK in 0.128 seconds
[0m14:26:32.537533 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m14:26:32.539518 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:26:32.540532 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.541167 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:26:32.543962 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:26:32.544569 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m14:26:32.545757 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.552937 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:26:32.553534 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m14:26:32.554694 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m14:26:32.559372 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:26:32.559965 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m14:26:32.560411 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:26:32.562566 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:26:32.566387 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:26:32.567008 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:26:32.569704 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:26:32.571916 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m14:26:32.573179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe723336790>]}
[0m14:26:32.574283 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.28s]
[0m14:26:32.575402 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m14:26:32.575982 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m14:26:32.576464 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:26:32.579820 [info ] [Thread-1 (]: 7 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m14:26:32.587021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_exacta_odds, now model.winticket_dbt.silver_tipster_predictions)
[0m14:26:32.587633 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m14:26:32.588074 [debug] [Thread-2 (]: SQL status: OK in 0.155 seconds
[0m14:26:32.594848 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:26:32.604231 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m14:26:32.603261 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.603724 [debug] [Thread-3 (]: SQL status: OK in 0.187 seconds
[0m14:26:32.598810 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.604946 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m14:26:32.610203 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:26:32.611444 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m14:26:32.612299 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m14:26:32.613003 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m14:26:32.615078 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m14:26:32.615610 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:26:32.619562 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.620608 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe726ed26d0>]}
[0m14:26:32.627542 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.628269 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.628977 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m14:26:32.629995 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.36s]
[0m14:26:32.630839 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m14:26:32.631261 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m14:26:32.634580 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:26:32.635538 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m14:26:32.636003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:32.636933 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m14:26:32.637644 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.642360 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:26:32.643947 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.644653 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:26:32.645103 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:26:32.645566 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m14:26:32.647034 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:26:32.648231 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.648790 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:26:32.649760 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
),
filtered as (
    select
        race_id,
        pred
    from rc
    cross join unnest(predictions) as p(pred)
    where pred['tipsterId']::varchar = 'dsc-00'
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from filtered
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m14:26:32.650280 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:26:32.650973 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:26:32.663055 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:26:32.664498 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m14:26:32.670771 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m14:26:32.684267 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:26:32.685543 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m14:26:32.691773 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m14:26:32.694195 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m14:26:32.697929 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe711f82490>]}
[0m14:26:32.698803 [info ] [Thread-2 (]: 6 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.31s]
[0m14:26:32.701603 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m14:26:32.702087 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m14:26:32.707343 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m14:26:32.709671 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe711f712d0>]}
[0m14:26:32.710906 [info ] [Thread-3 (]: 5 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.41s]
[0m14:26:32.711905 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m14:26:32.715724 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m14:26:32.716496 [info ] [Thread-4 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m14:26:32.718370 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_results, now model.winticket_dbt.silver_head_to_head)
[0m14:26:32.718832 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m14:26:32.722636 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.723419 [debug] [Thread-1 (]: SQL status: OK in 0.072 seconds
[0m14:26:32.726468 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.726850 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions" rename to "silver_tipster_predictions__dbt_backup"
[0m14:26:32.727354 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m14:26:32.732321 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.733268 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:26:32.736573 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.736996 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m14:26:32.737393 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.738099 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m14:26:32.738781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:32.739183 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.741353 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:26:32.741772 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.742366 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:26:32.742810 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:26:32.743361 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.743839 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m14:26:32.746980 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:26:32.752545 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:26:32.753512 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m14:26:32.758164 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:26:32.760577 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m14:26:32.761484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe720208810>]}
[0m14:26:32.762405 [info ] [Thread-1 (]: 7 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.17s]
[0m14:26:32.763219 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m14:26:32.844497 [debug] [Thread-4 (]: SQL status: OK in 0.100 seconds
[0m14:26:32.848071 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.848521 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m14:26:32.849631 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.852454 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.852806 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m14:26:32.853778 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:26:32.855091 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:26:32.855488 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.855850 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:26:32.860482 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:26:32.863615 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:26:32.864137 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m14:26:32.867928 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:26:32.869707 [debug] [Thread-4 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m14:26:32.895470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe720208210>]}
[0m14:26:32.896348 [info ] [Thread-4 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.18s]
[0m14:26:32.897416 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m14:26:32.899073 [debug] [Thread-3 (]: Began running node model.winticket_dbt.gold_entry_features
[0m14:26:32.900097 [info ] [Thread-3 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m14:26:32.901071 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_entries, now model.winticket_dbt.gold_entry_features)
[0m14:26:32.901561 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m14:26:32.912217 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m14:26:32.913109 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m14:26:32.936059 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m14:26:32.937354 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:26:32.937822 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m14:26:32.938187 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:26:33.012420 [debug] [Thread-3 (]: SQL status: OK in 0.074 seconds
[0m14:26:33.012975 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:26:33.013501 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        avg_exacta_odds_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.player_name,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case
        when r.finish_order = 1 then 1
        when r.finish_order is null then null
        else 0
    end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m14:26:34.767711 [debug] [Thread-3 (]: SQL status: OK in 1.753 seconds
[0m14:26:34.772410 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:26:34.773360 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m14:26:35.035933 [debug] [Thread-3 (]: SQL status: OK in 0.261 seconds
[0m14:26:35.074567 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:26:35.077156 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m14:26:35.081756 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:26:35.128090 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:26:35.130589 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:26:35.134223 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:26:36.126011 [debug] [Thread-3 (]: SQL status: OK in 0.991 seconds
[0m14:26:36.131148 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:26:36.131731 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m14:26:36.148866 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m14:26:36.150796 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: Close
[0m14:26:36.300583 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88a9e8f4-50ff-4d0b-9e74-471c04a907b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe720737250>]}
[0m14:26:36.301573 [info ] [Thread-3 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 3.40s]
[0m14:26:36.302383 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m14:26:36.304735 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:36.305197 [debug] [MainThread]: On master: BEGIN
[0m14:26:36.305710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:36.372179 [debug] [MainThread]: SQL status: OK in 0.066 seconds
[0m14:26:36.372749 [debug] [MainThread]: On master: COMMIT
[0m14:26:36.373086 [debug] [MainThread]: Using duckdb connection "master"
[0m14:26:36.373407 [debug] [MainThread]: On master: COMMIT
[0m14:26:36.374104 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:26:36.374506 [debug] [MainThread]: On master: Close
[0m14:26:36.378433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:36.378847 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_metadata' was properly closed.
[0m14:26:36.379073 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m14:26:36.379333 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m14:26:36.379567 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m14:26:36.379995 [info ] [MainThread]: 
[0m14:26:36.380631 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m14:26:36.382627 [debug] [MainThread]: Command end result
[0m14:26:36.408206 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:26:36.415301 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:26:36.421755 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m14:26:36.422174 [info ] [MainThread]: 
[0m14:26:36.423023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:36.423685 [info ] [MainThread]: 
[0m14:26:36.424350 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:26:36.431817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.16822, "process_in_blocks": "0", "process_kernel_time": 3.172346, "process_mem_max_rss": "466684", "process_out_blocks": "0", "process_user_time": 14.040994}
[0m14:26:36.432559 [debug] [MainThread]: Command `dbt run` succeeded at 14:26:36.432414 after 8.17 seconds
[0m14:26:36.433000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe729341510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe72b2acf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe72b3f0f10>]}
[0m14:26:36.433444 [debug] [MainThread]: Flushing usage events
[0m14:26:37.512813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:30.148829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e0860910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e0ab9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e0862b50>]}


============================== 14:33:30.167896 | 3aa5350a-0f02-4318-9bba-930e5133a921 ==============================
[0m14:33:30.167896 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:33:30.168978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'log_path': '/workspace/app/winticket_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:33:30.479263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e0719050>]}
[0m14:33:30.537974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e3223610>]}
[0m14:33:30.540556 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:33:30.674886 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:33:30.831283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:33:30.832730 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_exacta_odds.sql
[0m14:33:30.833512 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/silver/silver_race_entries.sql
[0m14:33:30.834113 [debug] [MainThread]: Partial parsing: updated file: winticket_dbt://models/gold/gold_entry_features.sql
[0m14:33:31.094414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59dcdc7cd0>]}
[0m14:33:31.151671 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:33:31.154719 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:33:31.211912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59da075ad0>]}
[0m14:33:31.212880 [info ] [MainThread]: Found 9 models, 543 macros
[0m14:33:31.214379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59daa53f90>]}
[0m14:33:31.225305 [info ] [MainThread]: 
[0m14:33:31.226551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:33:31.227100 [info ] [MainThread]: 
[0m14:33:31.228042 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:33:31.234035 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:33:31.234882 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:33:31.246358 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:33:31.380391 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:33:31.380880 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:33:31.381274 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:33:31.381596 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:33:31.381977 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:33:31.382327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:31.382636 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:33:31.382981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:31.383465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:32.752826 [debug] [ThreadPool]: SQL status: OK in 1.370 seconds
[0m14:33:32.754393 [debug] [ThreadPool]: SQL status: OK in 1.371 seconds
[0m14:33:32.772111 [debug] [ThreadPool]: SQL status: OK in 1.374 seconds
[0m14:33:32.796549 [debug] [ThreadPool]: On list_winticket: Close
[0m14:33:32.822403 [debug] [ThreadPool]: On list_winticket: Close
[0m14:33:32.828475 [debug] [ThreadPool]: On list_winticket: Close
[0m14:33:32.848650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m14:33:32.849316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m14:33:32.849817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m14:33:32.850415 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m14:33:32.850960 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m14:33:32.851514 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m14:33:32.860206 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:33:32.863442 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:33:32.866702 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:33:32.867319 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:33:32.867778 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:33:32.868182 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:33:32.868689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:32.869072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:32.869500 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:33.012844 [debug] [ThreadPool]: SQL status: OK in 0.143 seconds
[0m14:33:33.015935 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:33:33.018989 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m14:33:33.021601 [debug] [ThreadPool]: SQL status: OK in 0.152 seconds
[0m14:33:33.023868 [debug] [ThreadPool]: SQL status: OK in 0.154 seconds
[0m14:33:33.026627 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:33:33.030617 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m14:33:33.030134 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:33:33.031458 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m14:33:33.027738 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:33:33.031829 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:33:33.032497 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:33:33.033914 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:33:33.036412 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m14:33:33.035757 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m14:33:33.037411 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:33:33.040498 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:33:33.041880 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:33:33.043840 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:33:33.042836 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:33:33.042359 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m14:33:33.044221 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:33:33.045867 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:33:33.045126 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:33:33.046528 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:33:33.046932 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:33:33.047352 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:33:33.048613 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:33:33.049014 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:33:33.049399 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:33:33.049755 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:33:33.050055 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:33:33.051140 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m14:33:33.050496 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m14:33:33.052040 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:33:33.052884 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m14:33:33.058056 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_bronze)
[0m14:33:33.058880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_silver)
[0m14:33:33.059475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_gold)
[0m14:33:33.066992 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:33:33.071825 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:33:33.077492 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:33:33.078071 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m14:33:33.078477 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m14:33:33.078838 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m14:33:33.079251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:33.079601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:33.079964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:33.148109 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m14:33:33.148761 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:33:33.150297 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m14:33:33.151458 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m14:33:33.152098 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m14:33:33.152531 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:33:33.153332 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:33:33.153857 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m14:33:33.154358 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m14:33:33.173390 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m14:33:33.174446 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m14:33:33.176519 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m14:33:33.177753 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m14:33:33.178289 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m14:33:33.179851 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m14:33:33.180998 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m14:33:33.181430 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m14:33:33.181991 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m14:33:33.182976 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m14:33:33.183452 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m14:33:33.183983 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m14:33:33.189963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59dcd25f90>]}
[0m14:33:33.190684 [debug] [MainThread]: Using duckdb connection "master"
[0m14:33:33.190958 [debug] [MainThread]: On master: BEGIN
[0m14:33:33.191194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:33.254179 [debug] [MainThread]: SQL status: OK in 0.063 seconds
[0m14:33:33.254791 [debug] [MainThread]: On master: COMMIT
[0m14:33:33.255094 [debug] [MainThread]: Using duckdb connection "master"
[0m14:33:33.255399 [debug] [MainThread]: On master: COMMIT
[0m14:33:33.256023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:33:33.256433 [debug] [MainThread]: On master: Close
[0m14:33:33.261151 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m14:33:33.261689 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m14:33:33.262366 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m14:33:33.262874 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m14:33:33.263799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.bronze_race_results)
[0m14:33:33.264301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_racecards)
[0m14:33:33.264858 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m14:33:33.265223 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m14:33:33.275656 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m14:33:33.280120 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m14:33:33.281025 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m14:33:33.281403 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m14:33:33.323332 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m14:33:33.326052 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m14:33:33.326893 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:33:33.327321 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:33:33.327649 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m14:33:33.327977 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m14:33:33.328330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:33.328641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:33:33.395812 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m14:33:33.396440 [debug] [Thread-2 (]: SQL status: OK in 0.068 seconds
[0m14:33:33.396865 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:33:33.397300 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:33:33.397696 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m14:33:33.398075 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m14:33:33.535559 [debug] [Thread-2 (]: SQL status: OK in 0.137 seconds
[0m14:33:33.543424 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:33:33.543980 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m14:33:33.544612 [debug] [Thread-1 (]: SQL status: OK in 0.146 seconds
[0m14:33:33.548035 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:33:33.548558 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:33:33.548978 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m14:33:33.551825 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:33:33.552546 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m14:33:33.553213 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:33:33.556963 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:33:33.557524 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m14:33:33.557929 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:33:33.569108 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:33:33.571131 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:33:33.572658 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:33:33.573121 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:33:33.573566 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:33:33.573977 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:33:33.574347 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:33:33.581162 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:33:33.587917 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:33:33.588466 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m14:33:33.588930 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m14:33:33.591946 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:33:33.592800 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m14:33:33.595632 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:33:33.599210 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m14:33:33.599754 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:33:33.602849 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m14:33:33.603570 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d8412b50>]}
[0m14:33:33.604496 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.34s]
[0m14:33:33.605401 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m14:33:33.606598 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m14:33:33.607302 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m14:33:33.610131 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_exacta_odds'
[0m14:33:33.608919 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m14:33:33.611128 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m14:33:33.608075 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m14:33:33.612069 [info ] [Thread-2 (]: 5 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m14:33:33.618084 [info ] [Thread-3 (]: 4 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m14:33:33.619877 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.silver_race_entries)
[0m14:33:33.619104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m14:33:33.620915 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m14:33:33.617331 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.622101 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m14:33:33.639186 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m14:33:33.641234 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.642510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d84bf8d0>]}
[0m14:33:33.643821 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m14:33:33.646597 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.38s]
[0m14:33:33.648090 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m14:33:33.654173 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.655050 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m14:33:33.655429 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m14:33:33.659042 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m14:33:33.659873 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.660363 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m14:33:33.664055 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.664892 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m14:33:33.665767 [info ] [Thread-1 (]: 6 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m14:33:33.666703 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:33:33.667535 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:33:33.668223 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.669080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m14:33:33.669784 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m14:33:33.670747 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m14:33:33.671455 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m14:33:33.672083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:33:33.672730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:33:33.679583 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.680624 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m14:33:33.684325 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.685143 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.685633 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m14:33:33.685936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:33.741200 [debug] [Thread-4 (]: SQL status: OK in 0.074 seconds
[0m14:33:33.743697 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m14:33:33.744888 [debug] [Thread-2 (]: SQL status: OK in 0.072 seconds
[0m14:33:33.745523 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.745985 [debug] [Thread-1 (]: SQL status: OK in 0.060 seconds
[0m14:33:33.747778 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.746916 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.747371 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds,
        odds_struct['popularityOrder']::double as popularity_order
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    max(odds) as max_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first,
    max(odds) - min(odds) as spread_exacta_odds_first,
    min(popularity_order) as min_exacta_popularity_first,
    avg(popularity_order) as avg_exacta_popularity_first
from prep
group by 1,2
  );

[0m14:33:33.748134 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
),
filtered as (
    select
        race_id,
        pred
    from rc
    cross join unnest(predictions) as p(pred)
    where pred['tipsterId']::varchar = 'dsc-00'
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from filtered
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m14:33:33.746485 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:33:33.753014 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate,
        avg(case when rr['order'] <= 3 then 1 else 0 end)::double as recent_top3_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate,
        avg(case when rr['order'] <= 3 then 1 else 0 end)::double as venue_top3_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    r.rec['exLeftBehind']['percentage']::double as ex_leftbehind_pct,
    r.rec['linePositionFirst']['firstPercentage']::double as line_first_pct,
    r.rec['lineSingleHorseman']['firstPercentage']::double as line_single_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(f.recent_top3_rate, 0) as recent_top3_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate,
    coalesce(v.venue_top3_rate, 0) as venue_top3_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m14:33:33.748663 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m14:33:33.861598 [debug] [Thread-4 (]: SQL status: OK in 0.109 seconds
[0m14:33:33.865841 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.866474 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m14:33:33.871975 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:33:33.882721 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.886551 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m14:33:33.887920 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:33:33.889601 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:33:33.890030 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.893504 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:33:33.899653 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:33:33.907446 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:33:33.911740 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m14:33:33.913791 [debug] [Thread-2 (]: SQL status: OK in 0.151 seconds
[0m14:33:33.918495 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.919265 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m14:33:33.922817 [debug] [Thread-4 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m14:33:33.920347 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m14:33:33.919794 [debug] [Thread-1 (]: SQL status: OK in 0.170 seconds
[0m14:33:33.923376 [debug] [Thread-3 (]: SQL status: OK in 0.169 seconds
[0m14:33:33.924206 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d84ee7d0>]}
[0m14:33:33.929619 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.930178 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:33:33.933209 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:33:33.934743 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions" rename to "silver_tipster_predictions__dbt_backup"
[0m14:33:33.934014 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.31s]
[0m14:33:33.938531 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.939078 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m14:33:33.940600 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m14:33:33.943910 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m14:33:33.942199 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m14:33:33.941040 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:33:33.945192 [info ] [Thread-4 (]: 7 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m14:33:33.946344 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:33:33.950331 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.956987 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m14:33:33.952006 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:33:33.956445 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:33:33.950996 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_exacta_odds, now model.winticket_dbt.silver_race_results)
[0m14:33:33.959813 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:33:33.961224 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m14:33:33.962406 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:33:33.966176 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:33:33.963952 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.963107 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m14:33:33.966683 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.967100 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:33:33.967556 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:33:33.971676 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:33:33.971131 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m14:33:33.974480 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m14:33:33.973161 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:33:33.979913 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m14:33:33.980583 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:33:33.981125 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m14:33:33.981884 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:33:33.982295 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:33:33.982597 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:33:33.985467 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:33:33.985946 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m14:33:33.989965 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:33:33.990909 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m14:33:33.991566 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:33:33.992713 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m14:33:33.995758 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:33:33.996225 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:33:33.996741 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:33:33.997359 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m14:33:34.001045 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:33:34.001672 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:33:34.002097 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m14:33:34.003220 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m14:33:34.016611 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m14:33:34.010208 [debug] [Thread-1 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m14:33:34.029560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d8162510>]}
[0m14:33:34.028374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d84cbcd0>]}
[0m14:33:34.031122 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:33:34.030613 [info ] [Thread-1 (]: 6 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.36s]
[0m14:33:34.032051 [info ] [Thread-2 (]: 5 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.41s]
[0m14:33:34.036002 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m14:33:34.035325 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m14:33:34.034521 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m14:33:34.040956 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d84e7910>]}
[0m14:33:34.041811 [info ] [Thread-3 (]: 4 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.42s]
[0m14:33:34.042529 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m14:33:34.050311 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m14:33:34.054811 [info ] [Thread-2 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m14:33:34.055884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.silver_head_to_head)
[0m14:33:34.056400 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m14:33:34.064337 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.065128 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m14:33:34.068736 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.069415 [debug] [Thread-4 (]: SQL status: OK in 0.067 seconds
[0m14:33:34.072654 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:33:34.073094 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.073537 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m14:33:34.073900 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m14:33:34.074529 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:33:34.075319 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:33:34.079505 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:33:34.079974 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m14:33:34.080897 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:33:34.081356 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.081730 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:33:34.082088 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m14:33:34.083589 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:33:34.084497 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:33:34.084970 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:33:34.088415 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:33:34.092433 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:33:34.093053 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m14:33:34.096777 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:33:34.098865 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m14:33:34.099863 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d81e2010>]}
[0m14:33:34.100756 [info ] [Thread-4 (]: 7 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.15s]
[0m14:33:34.101525 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m14:33:34.208166 [debug] [Thread-2 (]: SQL status: OK in 0.124 seconds
[0m14:33:34.213742 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.214509 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m14:33:34.215978 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:33:34.219408 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.219846 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m14:33:34.220980 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:33:34.222583 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:33:34.222934 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.223225 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:33:34.226770 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:33:34.229618 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:33:34.229991 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m14:33:34.232663 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m14:33:34.234198 [debug] [Thread-2 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m14:33:34.282239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59d8184110>]}
[0m14:33:34.284138 [info ] [Thread-2 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.23s]
[0m14:33:34.285745 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m14:33:34.287294 [debug] [Thread-3 (]: Began running node model.winticket_dbt.gold_entry_features
[0m14:33:34.288048 [info ] [Thread-3 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m14:33:34.288949 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_entries, now model.winticket_dbt.gold_entry_features)
[0m14:33:34.289458 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m14:33:34.298276 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m14:33:34.299218 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m14:33:34.320112 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m14:33:34.321416 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:33:34.322172 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m14:33:34.322610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:33:34.385058 [debug] [Thread-3 (]: SQL status: OK in 0.062 seconds
[0m14:33:34.385657 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:33:34.386215 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        max_exacta_odds_first,
        avg_exacta_odds_first,
        spread_exacta_odds_first,
        min_exacta_popularity_first,
        avg_exacta_popularity_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.player_name,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.recent_top3_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    b.venue_top3_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(b.ex_leftbehind_pct, 0) as exLeftBehind,
    coalesce(b.line_first_pct, 0) as lineFirstPct,
    coalesce(b.line_single_pct, 0) as lineSinglePct,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.max_exacta_odds_first, 0) as max_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    coalesce(o.spread_exacta_odds_first, 0) as spread_exacta_odds_first,
    coalesce(o.min_exacta_popularity_first, 0) as min_exacta_popularity_first,
    coalesce(o.avg_exacta_popularity_first, 0) as avg_exacta_popularity_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case
        when r.finish_order = 1 then 1
        when r.finish_order is null then null
        else 0
    end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m14:33:35.783104 [debug] [Thread-3 (]: SQL status: OK in 1.387 seconds
[0m14:33:35.796516 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:33:35.797367 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m14:33:35.817689 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m14:33:35.824381 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:33:35.825385 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m14:33:35.827955 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m14:33:35.835750 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:33:35.836304 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:33:35.836660 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:33:35.843878 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:33:35.846840 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:33:35.847214 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m14:33:35.854881 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m14:33:35.856519 [debug] [Thread-3 (]: On model.winticket_dbt.gold_entry_features: Close
[0m14:33:35.957871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aa5350a-0f02-4318-9bba-930e5133a921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59b089fbd0>]}
[0m14:33:35.961864 [info ] [Thread-3 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 1.67s]
[0m14:33:35.962937 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m14:33:35.970418 [debug] [MainThread]: Using duckdb connection "master"
[0m14:33:35.971000 [debug] [MainThread]: On master: BEGIN
[0m14:33:35.971416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:36.121032 [debug] [MainThread]: SQL status: OK in 0.149 seconds
[0m14:33:36.121716 [debug] [MainThread]: On master: COMMIT
[0m14:33:36.124891 [debug] [MainThread]: Using duckdb connection "master"
[0m14:33:36.127184 [debug] [MainThread]: On master: COMMIT
[0m14:33:36.128349 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m14:33:36.128873 [debug] [MainThread]: On master: Close
[0m14:33:36.134338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:36.135047 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m14:33:36.135415 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m14:33:36.135743 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m14:33:36.135999 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_race_results' was properly closed.
[0m14:33:36.136607 [info ] [MainThread]: 
[0m14:33:36.138828 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 4.91 seconds (4.91s).
[0m14:33:36.141518 [debug] [MainThread]: Command end result
[0m14:33:36.168144 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:33:36.174940 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:33:36.182041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m14:33:36.182492 [info ] [MainThread]: 
[0m14:33:36.183194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:36.183800 [info ] [MainThread]: 
[0m14:33:36.184438 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:33:36.187691 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1452255, "process_in_blocks": "0", "process_kernel_time": 2.428466, "process_mem_max_rss": "440804", "process_out_blocks": "0", "process_user_time": 11.576878}
[0m14:33:36.188394 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:36.188221 after 6.15 seconds
[0m14:33:36.188825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e094af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e0ab9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59e4e0f990>]}
[0m14:33:36.189237 [debug] [MainThread]: Flushing usage events
[0m14:33:37.235347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:32.948619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276de66a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276eb6a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276e0cd010>]}


============================== 14:48:32.963320 | 0588d60c-8e39-4783-b39f-5a149a4e7c2d ==============================
[0m14:48:32.963320 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:48:32.964232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/workspace/app/winticket_dbt/profiles', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspace/app/winticket_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:48:33.296517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276df307d0>]}
[0m14:48:33.354743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2770849310>]}
[0m14:48:33.365981 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:48:33.514945 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:48:33.683525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:33.684015 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:33.713509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27639a6610>]}
[0m14:48:33.806800 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:48:33.808980 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:48:33.858240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276814bc90>]}
[0m14:48:33.859483 [info ] [MainThread]: Found 9 models, 543 macros
[0m14:48:33.860574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2768207110>]}
[0m14:48:33.863885 [info ] [MainThread]: 
[0m14:48:33.864550 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:33.865072 [info ] [MainThread]: 
[0m14:48:33.865904 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:48:33.871823 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:48:33.872810 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:48:33.883985 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_winticket'
[0m14:48:33.979140 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:48:33.979687 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:48:33.979978 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:48:33.980347 [debug] [ThreadPool]: Using duckdb connection "list_winticket"
[0m14:48:33.980736 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:48:33.981072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.981399 [debug] [ThreadPool]: On list_winticket: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"winticket"'
    
  
  
[0m14:48:33.981755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:33.982227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:35.163394 [debug] [ThreadPool]: SQL status: OK in 1.182 seconds
[0m14:48:35.164216 [debug] [ThreadPool]: SQL status: OK in 1.182 seconds
[0m14:48:35.166286 [debug] [ThreadPool]: On list_winticket: Close
[0m14:48:35.167000 [debug] [ThreadPool]: SQL status: OK in 1.185 seconds
[0m14:48:35.168908 [debug] [ThreadPool]: On list_winticket: Close
[0m14:48:35.170644 [debug] [ThreadPool]: On list_winticket: Close
[0m14:48:35.175301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_silver)
[0m14:48:35.175865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_bronze)
[0m14:48:35.176238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_winticket, now create_winticket_main_gold)
[0m14:48:35.176908 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_silver"
"
[0m14:48:35.177498 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_bronze"
"
[0m14:48:35.178006 [debug] [ThreadPool]: Creating schema "database: "winticket"
schema: "main_gold"
"
[0m14:48:35.185610 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:48:35.188003 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:48:35.190023 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:48:35.190469 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:48:35.190862 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:48:35.191237 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
        select type from duckdb_databases()
        where lower(database_name)='winticket'
        and type='sqlite'
    
  
[0m14:48:35.191614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:35.191967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:35.192325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:35.255406 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m14:48:35.256048 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m14:48:35.256473 [debug] [ThreadPool]: SQL status: OK in 0.064 seconds
[0m14:48:35.258080 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:48:35.259438 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:48:35.260726 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:48:35.261091 [debug] [ThreadPool]: On create_winticket_main_silver: BEGIN
[0m14:48:35.261588 [debug] [ThreadPool]: On create_winticket_main_bronze: BEGIN
[0m14:48:35.262031 [debug] [ThreadPool]: On create_winticket_main_gold: BEGIN
[0m14:48:35.263130 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.263583 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.263918 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:48:35.264271 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.264647 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:48:35.265037 [debug] [ThreadPool]: On create_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_silver"} */

    
    
        create schema if not exists "winticket"."main_silver"
    
[0m14:48:35.265478 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:48:35.266027 [debug] [ThreadPool]: On create_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_bronze"} */

    
    
        create schema if not exists "winticket"."main_bronze"
    
[0m14:48:35.266976 [debug] [ThreadPool]: On create_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "create_winticket_main_gold"} */

    
    
        create schema if not exists "winticket"."main_gold"
    
[0m14:48:35.267636 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.268096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.269360 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:48:35.270300 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:48:35.270665 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m14:48:35.271006 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_silver"
[0m14:48:35.271402 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_bronze"
[0m14:48:35.272316 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:48:35.272631 [debug] [ThreadPool]: On create_winticket_main_silver: COMMIT
[0m14:48:35.272979 [debug] [ThreadPool]: On create_winticket_main_bronze: COMMIT
[0m14:48:35.273372 [debug] [ThreadPool]: Using duckdb connection "create_winticket_main_gold"
[0m14:48:35.274149 [debug] [ThreadPool]: On create_winticket_main_gold: COMMIT
[0m14:48:35.274632 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.274986 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.275481 [debug] [ThreadPool]: On create_winticket_main_silver: Close
[0m14:48:35.275995 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m14:48:35.276344 [debug] [ThreadPool]: On create_winticket_main_bronze: Close
[0m14:48:35.277677 [debug] [ThreadPool]: On create_winticket_main_gold: Close
[0m14:48:35.291042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_gold, now list_winticket_main_silver)
[0m14:48:35.293189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_silver, now list_winticket_main_bronze)
[0m14:48:35.293920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_winticket_main_bronze, now list_winticket_main_gold)
[0m14:48:35.301919 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:48:35.305720 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:48:35.308044 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:48:35.308526 [debug] [ThreadPool]: On list_winticket_main_silver: BEGIN
[0m14:48:35.308907 [debug] [ThreadPool]: On list_winticket_main_bronze: BEGIN
[0m14:48:35.309251 [debug] [ThreadPool]: On list_winticket_main_gold: BEGIN
[0m14:48:35.309614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:35.309971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:35.310307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:35.375405 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m14:48:35.375900 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m14:48:35.376464 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_bronze"
[0m14:48:35.376845 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_silver"
[0m14:48:35.377160 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m14:48:35.377585 [debug] [ThreadPool]: On list_winticket_main_bronze: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_bronze"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_bronze'
    and lower(table_catalog) = 'winticket'
  
[0m14:48:35.377982 [debug] [ThreadPool]: On list_winticket_main_silver: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_silver"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_silver'
    and lower(table_catalog) = 'winticket'
  
[0m14:48:35.378391 [debug] [ThreadPool]: Using duckdb connection "list_winticket_main_gold"
[0m14:48:35.379539 [debug] [ThreadPool]: On list_winticket_main_gold: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "connection_name": "list_winticket_main_gold"} */
select
      'winticket' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_gold'
    and lower(table_catalog) = 'winticket'
  
[0m14:48:35.408299 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m14:48:35.409377 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m14:48:35.410817 [debug] [ThreadPool]: On list_winticket_main_bronze: ROLLBACK
[0m14:48:35.411234 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m14:48:35.412740 [debug] [ThreadPool]: On list_winticket_main_gold: ROLLBACK
[0m14:48:35.414407 [debug] [ThreadPool]: On list_winticket_main_silver: ROLLBACK
[0m14:48:35.415836 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_silver'
[0m14:48:35.416430 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_bronze'
[0m14:48:35.416762 [debug] [ThreadPool]: On list_winticket_main_silver: Close
[0m14:48:35.417140 [debug] [ThreadPool]: Failed to rollback 'list_winticket_main_gold'
[0m14:48:35.417502 [debug] [ThreadPool]: On list_winticket_main_bronze: Close
[0m14:48:35.417894 [debug] [ThreadPool]: On list_winticket_main_gold: Close
[0m14:48:35.424913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2768309190>]}
[0m14:48:35.425658 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:35.425962 [debug] [MainThread]: On master: BEGIN
[0m14:48:35.426219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:48:35.491763 [debug] [MainThread]: SQL status: OK in 0.065 seconds
[0m14:48:35.492364 [debug] [MainThread]: On master: COMMIT
[0m14:48:35.492667 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:35.492924 [debug] [MainThread]: On master: COMMIT
[0m14:48:35.493501 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:35.493865 [debug] [MainThread]: On master: Close
[0m14:48:35.498879 [debug] [Thread-1 (]: Began running node model.winticket_dbt.bronze_race_results
[0m14:48:35.499464 [debug] [Thread-2 (]: Began running node model.winticket_dbt.bronze_racecards
[0m14:48:35.500158 [info ] [Thread-1 (]: 1 of 9 START sql view model main_bronze.bronze_race_results .................... [RUN]
[0m14:48:35.500990 [info ] [Thread-2 (]: 2 of 9 START sql view model main_bronze.bronze_racecards ....................... [RUN]
[0m14:48:35.501806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_winticket_main_silver, now model.winticket_dbt.bronze_race_results)
[0m14:48:35.502282 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_winticket_main_bronze, now model.winticket_dbt.bronze_racecards)
[0m14:48:35.502706 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.bronze_race_results
[0m14:48:35.503116 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.bronze_racecards
[0m14:48:35.514059 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.bronze_race_results"
[0m14:48:35.519683 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.bronze_racecards"
[0m14:48:35.521169 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.bronze_race_results
[0m14:48:35.536499 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.bronze_racecards
[0m14:48:35.632551 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.bronze_race_results"
[0m14:48:35.633159 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.bronze_racecards"
[0m14:48:35.633993 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:48:35.634422 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:48:35.634820 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: BEGIN
[0m14:48:35.635165 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: BEGIN
[0m14:48:35.635567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:35.635896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:35.703117 [debug] [Thread-1 (]: SQL status: OK in 0.067 seconds
[0m14:48:35.703830 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:48:35.704317 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */

  
  create view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/results/*.json')
  );

[0m14:48:35.704701 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m14:48:35.705453 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:48:35.705962 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */

  
  create view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" as (
    

select
  meta['raceId']::varchar as race_id,
  meta['cupId']::varchar as cup_id,
  meta['raceNumber']::int as race_number,
  meta['index']::int as day_index,
  meta['venueSlug']::varchar as venue_slug,
  meta['capturedAt']::varchar as captured_at,
  meta,
  state
from read_json_auto('/workspace/app/data/winticket_lake/bronze/racecards/*.json')
  );

[0m14:48:35.835275 [debug] [Thread-1 (]: SQL status: OK in 0.130 seconds
[0m14:48:35.846149 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:48:35.846917 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results" rename to "bronze_race_results__dbt_backup"
[0m14:48:35.848411 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:48:35.852148 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:48:35.852678 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
alter view "winticket"."main_bronze"."bronze_race_results__dbt_tmp" rename to "bronze_race_results"
[0m14:48:35.853809 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:48:35.866067 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:48:35.866614 [debug] [Thread-2 (]: SQL status: OK in 0.159 seconds
[0m14:48:35.867082 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:48:35.870236 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:48:35.870746 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: COMMIT
[0m14:48:35.871173 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards" rename to "bronze_racecards__dbt_backup"
[0m14:48:35.872496 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:48:35.876515 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:48:35.877101 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
alter view "winticket"."main_bronze"."bronze_racecards__dbt_tmp" rename to "bronze_racecards"
[0m14:48:35.877557 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:48:35.883755 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.bronze_race_results"
[0m14:48:35.884323 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:48:35.884809 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_race_results"} */
drop view if exists "winticket"."main_bronze"."bronze_race_results__dbt_backup" cascade
[0m14:48:35.886455 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:48:35.887259 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:48:35.887726 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: COMMIT
[0m14:48:35.889922 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m14:48:35.893002 [debug] [Thread-1 (]: On model.winticket_dbt.bronze_race_results: Close
[0m14:48:35.893638 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:48:35.897955 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.bronze_racecards"
[0m14:48:35.898412 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.bronze_racecards"} */
drop view if exists "winticket"."main_bronze"."bronze_racecards__dbt_backup" cascade
[0m14:48:35.899127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2761c12b90>]}
[0m14:48:35.900117 [info ] [Thread-1 (]: 1 of 9 OK created sql view model main_bronze.bronze_race_results ............... [[32mOK[0m in 0.39s]
[0m14:48:35.901318 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.bronze_race_results
[0m14:48:35.902024 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:48:35.904398 [debug] [Thread-2 (]: On model.winticket_dbt.bronze_racecards: Close
[0m14:48:35.902817 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_race_results
[0m14:48:35.905035 [info ] [Thread-4 (]: 3 of 9 START sql view model main_silver.silver_race_results .................... [RUN]
[0m14:48:35.905764 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.winticket_dbt.silver_race_results'
[0m14:48:35.906462 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_race_results
[0m14:48:35.913281 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_results"
[0m14:48:35.914182 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_race_results
[0m14:48:35.926365 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_results"
[0m14:48:35.928663 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:48:35.930523 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: BEGIN
[0m14:48:35.933942 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:48:35.941387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27639a49d0>]}
[0m14:48:35.944200 [info ] [Thread-2 (]: 2 of 9 OK created sql view model main_bronze.bronze_racecards .................. [[32mOK[0m in 0.44s]
[0m14:48:35.946570 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.bronze_racecards
[0m14:48:35.949854 [debug] [Thread-1 (]: Began running node model.winticket_dbt.silver_exacta_odds
[0m14:48:35.951204 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_race_entries
[0m14:48:35.952425 [debug] [Thread-2 (]: Began running node model.winticket_dbt.silver_race_metadata
[0m14:48:35.953814 [info ] [Thread-1 (]: 4 of 9 START sql view model main_silver.silver_exacta_odds ..................... [RUN]
[0m14:48:35.955802 [info ] [Thread-3 (]: 5 of 9 START sql view model main_silver.silver_race_entries .................... [RUN]
[0m14:48:35.960690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_winticket_main_gold, now model.winticket_dbt.silver_race_entries)
[0m14:48:35.959571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_race_results, now model.winticket_dbt.silver_exacta_odds)
[0m14:48:35.957938 [info ] [Thread-2 (]: 6 of 9 START sql view model main_silver.silver_race_metadata ................... [RUN]
[0m14:48:35.961877 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_race_entries
[0m14:48:35.963284 [debug] [Thread-1 (]: Began compiling node model.winticket_dbt.silver_exacta_odds
[0m14:48:35.964471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.bronze_racecards, now model.winticket_dbt.silver_race_metadata)
[0m14:48:35.975436 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_entries"
[0m14:48:35.981780 [debug] [Thread-1 (]: Writing injected SQL for node "model.winticket_dbt.silver_exacta_odds"
[0m14:48:35.982330 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.silver_race_metadata
[0m14:48:35.983448 [debug] [Thread-1 (]: Began executing node model.winticket_dbt.silver_exacta_odds
[0m14:48:35.987531 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.silver_race_metadata"
[0m14:48:35.988098 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_race_entries
[0m14:48:35.991955 [debug] [Thread-1 (]: Writing runtime sql for node "model.winticket_dbt.silver_exacta_odds"
[0m14:48:36.036071 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.silver_race_metadata
[0m14:48:36.040191 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_entries"
[0m14:48:36.041380 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:48:36.047982 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.silver_race_metadata"
[0m14:48:36.050600 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:48:36.049266 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: BEGIN
[0m14:48:36.051423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:36.049959 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:48:36.050973 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: BEGIN
[0m14:48:36.048571 [debug] [Thread-4 (]: SQL status: OK in 0.116 seconds
[0m14:48:36.052614 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: BEGIN
[0m14:48:36.053081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:36.053746 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:48:36.054130 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:48:36.055116 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */

  
  create view "winticket"."main_silver"."silver_race_results__dbt_tmp" as (
    

with rr as (
    select
        race_id,
        state['race_common']['results'] as results
    from "winticket"."main_bronze"."bronze_race_results"
)
select
    race_id,
    result['playerId']::varchar as player_id,
    result['order']::int as finish_order,
    result['factor']::varchar as finish_factor,
    result['finalHalfRecord']::varchar as final_half_record
from rr
cross join unnest(results) as r(result)
  );

[0m14:48:36.055938 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:48:36.056856 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m14:48:36.059017 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:48:36.059989 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */

  
  create view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['race'] as race_struct,
        state['race_common']['schedule'] as schedule_struct
    from "winticket"."main_bronze"."bronze_racecards"
)
select
    race_id,
    cup_id,
    race_number,
    day_index,
    venue_slug,
    schedule_struct['date']::varchar as schedule_date,
    schedule_struct['day']::int as schedule_day,
    race_struct['distance']::int as distance_m,
    race_struct['class']::varchar as race_class,
    race_struct['raceType3']::varchar as race_phase,
    race_struct['weather']::varchar as weather,
    race_struct['windSpeed']::varchar as wind_speed,
    race_struct['entriesNumber']::int as entries_number,
    race_struct['startAt']::bigint as start_at_epoch,
    race_struct['closeAt']::bigint as close_at_epoch
from rc
  );

[0m14:48:36.058007 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:48:36.061973 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */

  
  create view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" as (
    

with odds as (
    select
        race_id,
        odds_struct
    from "winticket"."main_bronze"."bronze_racecards"
    cross join unnest(state['race_odds']['exacta']) as o(odds_struct)
),
prep as (
    select
        race_id,
        odds_struct['key'][1]::int as first_number,
        odds_struct['key'][2]::int as second_number,
        odds_struct['odds']::double as odds,
        odds_struct['popularityOrder']::double as popularity_order
    from odds
    where coalesce(odds_struct['absent']::boolean, false) = false
)
select
    race_id,
    first_number,
    min(odds) as min_exacta_odds_first,
    max(odds) as max_exacta_odds_first,
    avg(odds) as avg_exacta_odds_first,
    max(odds) - min(odds) as spread_exacta_odds_first,
    min(popularity_order) as min_exacta_popularity_first,
    avg(popularity_order) as avg_exacta_popularity_first
from prep
group by 1,2
  );

[0m14:48:36.063110 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m14:48:36.065211 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:48:36.066711 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */

  
  create view "winticket"."main_silver"."silver_race_entries__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        cup_id,
        race_number,
        day_index,
        venue_slug,
        state['race_common']['entries'] as entries,
        state['race_common']['records'] as records,
        state['race_common']['players'] as players
    from "winticket"."main_bronze"."bronze_racecards"
),
entries as (
    select
        race_id,
        entry['playerId']::varchar as player_id,
        entry['number']::int as number,
        entry['bracketNumber']::int as bracket_number,
        entry['absent']::boolean as is_absent,
        entry
    from rc
    cross join unnest(entries) as e(entry)
),
records as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        rec
    from rc
    cross join unnest(records) as r(rec)
),
players as (
    select
        race_id,
        pl['id']::varchar as player_id,
        pl
    from rc
    cross join unnest(players) as p(pl)
),
recent_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as recent_races,
        avg(rr['order']::double)::double as recent_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as recent_win_rate,
        avg(case when rr['order'] <= 3 then 1 else 0 end)::double as recent_top3_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestCupResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
),
venue_form as (
    select
        race_id,
        rec['playerId']::varchar as player_id,
        count(*)::int as venue_races,
        avg(rr['order']::double)::double as venue_avg_order,
        avg(case when rr['order'] = 1 then 1 else 0 end)::double as venue_win_rate,
        avg(case when rr['order'] <= 3 then 1 else 0 end)::double as venue_top3_rate
    from rc
    cross join unnest(records) as r(rec)
    cross join unnest(r.rec['latestVenueResults']) as cup(cup_struct)
    cross join unnest(cup.cup_struct['raceResults']) as rr(rr)
    group by 1,2
)
select
    e.race_id,
    rc.cup_id,
    rc.race_number,
    rc.day_index,
    rc.venue_slug,
    e.player_id,
    e.number,
    e.bracket_number,
    e.is_absent,
    r.rec['racePoint']::double as race_point,
    r.rec['firstRate']::double as first_rate,
    r.rec['secondRate']::double as second_rate,
    r.rec['thirdRate']::double as third_rate,
    r.rec['gearRatio']::double as gear_ratio,
    r.rec['predictionMark']::int as prediction_mark,
    r.rec['comment']::varchar as prediction_comment,
    r.rec['style']::varchar as running_style,
    r.rec['exSpurt']['percentage']::double as ex_spurt_pct,
    r.rec['exThrust']['percentage']::double as ex_thrust_pct,
    r.rec['exSplitLine']['percentage']::double as ex_split_pct,
    r.rec['exCompete']['percentage']::double as ex_compete_pct,
    r.rec['exLeftBehind']['percentage']::double as ex_leftbehind_pct,
    r.rec['linePositionFirst']['firstPercentage']::double as line_first_pct,
    r.rec['lineSingleHorseman']['firstPercentage']::double as line_single_pct,
    p.pl['name']::varchar as player_name,
    p.pl['prefecture']::varchar as prefecture,
    p.pl['age']::int as age,
    p.pl['class']::int as player_class,
    p.pl['group']::int as player_group,
    p.pl['regionId']::varchar as region_id,
    coalesce(f.recent_races, 0) as recent_races,
    coalesce(f.recent_avg_order, 0) as recent_avg_order,
    coalesce(f.recent_win_rate, 0) as recent_win_rate,
    coalesce(f.recent_top3_rate, 0) as recent_top3_rate,
    coalesce(v.venue_races, 0) as venue_races,
    coalesce(v.venue_avg_order, 0) as venue_avg_order,
    coalesce(v.venue_win_rate, 0) as venue_win_rate,
    coalesce(v.venue_top3_rate, 0) as venue_top3_rate
from entries e
join rc on e.race_id = rc.race_id
left join records r on e.race_id = r.race_id and e.player_id = r.player_id
left join players p on e.race_id = p.race_id and e.player_id = p.player_id
left join recent_form f on e.race_id = f.race_id and e.player_id = f.player_id
left join venue_form v on e.race_id = v.race_id and e.player_id = v.player_id
  );

[0m14:48:36.206986 [debug] [Thread-4 (]: SQL status: OK in 0.149 seconds
[0m14:48:36.214863 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:48:36.218733 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results" rename to "silver_race_results__dbt_backup"
[0m14:48:36.220070 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m14:48:36.231400 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:48:36.232156 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
alter view "winticket"."main_silver"."silver_race_results__dbt_tmp" rename to "silver_race_results"
[0m14:48:36.236664 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:48:36.238980 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:48:36.242852 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:48:36.243470 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: COMMIT
[0m14:48:36.249725 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:48:36.267500 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_race_results"
[0m14:48:36.268164 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_results"} */
drop view if exists "winticket"."main_silver"."silver_race_results__dbt_backup" cascade
[0m14:48:36.277390 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m14:48:36.280282 [debug] [Thread-4 (]: On model.winticket_dbt.silver_race_results: Close
[0m14:48:36.281386 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2761c80510>]}
[0m14:48:36.286470 [info ] [Thread-4 (]: 3 of 9 OK created sql view model main_silver.silver_race_results ............... [[32mOK[0m in 0.38s]
[0m14:48:36.287628 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_race_results
[0m14:48:36.288201 [debug] [Thread-4 (]: Began running node model.winticket_dbt.silver_tipster_predictions
[0m14:48:36.288817 [info ] [Thread-4 (]: 7 of 9 START sql view model main_silver.silver_tipster_predictions ............. [RUN]
[0m14:48:36.293050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_results, now model.winticket_dbt.silver_tipster_predictions)
[0m14:48:36.293700 [debug] [Thread-4 (]: Began compiling node model.winticket_dbt.silver_tipster_predictions
[0m14:48:36.302615 [debug] [Thread-3 (]: SQL status: OK in 0.229 seconds
[0m14:48:36.305623 [debug] [Thread-4 (]: Writing injected SQL for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.310022 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:48:36.312752 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries" rename to "silver_race_entries__dbt_backup"
[0m14:48:36.311000 [debug] [Thread-4 (]: Began executing node model.winticket_dbt.silver_tipster_predictions
[0m14:48:36.322815 [debug] [Thread-4 (]: Writing runtime sql for node "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.323371 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m14:48:36.324005 [debug] [Thread-2 (]: SQL status: OK in 0.263 seconds
[0m14:48:36.332299 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.333072 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:48:36.337195 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:48:36.338963 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata" rename to "silver_race_metadata__dbt_backup"
[0m14:48:36.338468 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
alter view "winticket"."main_silver"."silver_race_entries__dbt_tmp" rename to "silver_race_entries"
[0m14:48:36.337812 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: BEGIN
[0m14:48:36.340199 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:48:36.340903 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:48:36.344497 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:48:36.345091 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:48:36.346159 [debug] [Thread-1 (]: SQL status: OK in 0.282 seconds
[0m14:48:36.346748 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
alter view "winticket"."main_silver"."silver_race_metadata__dbt_tmp" rename to "silver_race_metadata"
[0m14:48:36.349493 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:48:36.354765 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:48:36.355270 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m14:48:36.357626 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.356752 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds" rename to "silver_exacta_odds__dbt_backup"
[0m14:48:36.357173 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:48:36.357993 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */

  
  create view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['predictions'] as predictions
    from "winticket"."main_bronze"."bronze_racecards"
),
filtered as (
    select
        race_id,
        pred
    from rc
    cross join unnest(predictions) as p(pred)
    where pred['tipsterId']::varchar = 'dsc-00'
)
select
    race_id,
    pred['tipsterId']::varchar as tipster_id,
    pred['name']::varchar as tipster_name,
    idx.generate_series::int as pick_rank,
    list_extract(pred['order'], idx.generate_series)::int as number
from filtered
cross join generate_series(1, array_length(pred['order'])) as idx(generate_series)
  );

[0m14:48:36.360758 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m14:48:36.359923 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:48:36.356101 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:48:36.367618 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:48:36.368497 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:48:36.369203 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: COMMIT
[0m14:48:36.372890 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
alter view "winticket"."main_silver"."silver_exacta_odds__dbt_tmp" rename to "silver_exacta_odds"
[0m14:48:36.377731 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:48:36.373675 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: COMMIT
[0m14:48:36.382089 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:48:36.384287 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:48:36.384815 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: COMMIT
[0m14:48:36.387240 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m14:48:36.399606 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_race_entries"
[0m14:48:36.400412 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_entries"} */
drop view if exists "winticket"."main_silver"."silver_race_entries__dbt_backup" cascade
[0m14:48:36.400991 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m14:48:36.401582 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m14:48:36.418207 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.silver_race_metadata"
[0m14:48:36.422770 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_race_metadata"} */
drop view if exists "winticket"."main_silver"."silver_race_metadata__dbt_backup" cascade
[0m14:48:36.419558 [debug] [Thread-1 (]: Using duckdb connection "model.winticket_dbt.silver_exacta_odds"
[0m14:48:36.424300 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_exacta_odds"} */
drop view if exists "winticket"."main_silver"."silver_exacta_odds__dbt_backup" cascade
[0m14:48:36.425698 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m14:48:36.427617 [debug] [Thread-3 (]: On model.winticket_dbt.silver_race_entries: Close
[0m14:48:36.431894 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f276df10fd0>]}
[0m14:48:36.432510 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m14:48:36.433433 [info ] [Thread-3 (]: 5 of 9 OK created sql view model main_silver.silver_race_entries ............... [[32mOK[0m in 0.47s]
[0m14:48:36.435525 [debug] [Thread-2 (]: On model.winticket_dbt.silver_race_metadata: Close
[0m14:48:36.435951 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m14:48:36.436655 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_race_entries
[0m14:48:36.438228 [debug] [Thread-1 (]: On model.winticket_dbt.silver_exacta_odds: Close
[0m14:48:36.438827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2760b8a050>]}
[0m14:48:36.439823 [debug] [Thread-3 (]: Began running node model.winticket_dbt.silver_head_to_head
[0m14:48:36.440553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2760b85f90>]}
[0m14:48:36.441405 [info ] [Thread-2 (]: 6 of 9 OK created sql view model main_silver.silver_race_metadata .............. [[32mOK[0m in 0.47s]
[0m14:48:36.442238 [info ] [Thread-3 (]: 8 of 9 START sql view model main_silver.silver_head_to_head .................... [RUN]
[0m14:48:36.443777 [debug] [Thread-4 (]: SQL status: OK in 0.083 seconds
[0m14:48:36.443191 [info ] [Thread-1 (]: 4 of 9 OK created sql view model main_silver.silver_exacta_odds ................ [[32mOK[0m in 0.48s]
[0m14:48:36.444593 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.silver_race_metadata
[0m14:48:36.445189 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_entries, now model.winticket_dbt.silver_head_to_head)
[0m14:48:36.451438 [debug] [Thread-3 (]: Began compiling node model.winticket_dbt.silver_head_to_head
[0m14:48:36.450837 [debug] [Thread-1 (]: Finished running node model.winticket_dbt.silver_exacta_odds
[0m14:48:36.449980 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.454833 [debug] [Thread-3 (]: Writing injected SQL for node "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.455519 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions" rename to "silver_tipster_predictions__dbt_backup"
[0m14:48:36.456547 [debug] [Thread-3 (]: Began executing node model.winticket_dbt.silver_head_to_head
[0m14:48:36.460332 [debug] [Thread-3 (]: Writing runtime sql for node "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.460854 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:48:36.465302 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.465901 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
alter view "winticket"."main_silver"."silver_tipster_predictions__dbt_tmp" rename to "silver_tipster_predictions"
[0m14:48:36.466306 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.467041 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: BEGIN
[0m14:48:36.467644 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:48:36.468401 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:48:36.470062 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:48:36.470698 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.471212 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: COMMIT
[0m14:48:36.471626 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:48:36.472077 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.472729 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */

  
  create view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" as (
    

with rc as (
    select
        race_id,
        state['race_common']['competitionRecords'] as competition_records
    from "winticket"."main_bronze"."bronze_racecards"
),
flat as (
    select
        race_id,
        comp['playerId']::varchar as player_id,
        comp['opponentId']::varchar as opponent_id,
        coalesce(comp['wins']::int, 0) as wins,
        coalesce(comp['losses']::int, 0) as losses
    from rc
    cross join unnest(competition_records) as c(comp)
),
field_entries as (
    select distinct race_id, player_id
    from "winticket"."main_silver"."silver_race_entries"
)
select
    f.race_id,
    f.player_id,
    sum(f.wins) filter (where fe.player_id is not null) as field_head_to_head_wins,
    sum(f.losses) filter (where fe.player_id is not null) as field_head_to_head_losses,
    sum(f.wins + f.losses) filter (where fe.player_id is not null) as field_head_to_head_races
from flat f
left join field_entries fe
    on f.race_id = fe.race_id
   and f.opponent_id = fe.player_id
group by 1,2
  );

[0m14:48:36.490902 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:48:36.508941 [debug] [Thread-4 (]: Using duckdb connection "model.winticket_dbt.silver_tipster_predictions"
[0m14:48:36.509706 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_tipster_predictions"} */
drop view if exists "winticket"."main_silver"."silver_tipster_predictions__dbt_backup" cascade
[0m14:48:36.513400 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m14:48:36.515602 [debug] [Thread-4 (]: On model.winticket_dbt.silver_tipster_predictions: Close
[0m14:48:36.516596 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2761c80c50>]}
[0m14:48:36.518320 [info ] [Thread-4 (]: 7 of 9 OK created sql view model main_silver.silver_tipster_predictions ........ [[32mOK[0m in 0.22s]
[0m14:48:36.519708 [debug] [Thread-4 (]: Finished running node model.winticket_dbt.silver_tipster_predictions
[0m14:48:36.629014 [debug] [Thread-3 (]: SQL status: OK in 0.156 seconds
[0m14:48:36.633877 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.634357 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head" rename to "silver_head_to_head__dbt_backup"
[0m14:48:36.635547 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:48:36.638780 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.639175 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
alter view "winticket"."main_silver"."silver_head_to_head__dbt_tmp" rename to "silver_head_to_head"
[0m14:48:36.640203 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m14:48:36.641642 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:48:36.641992 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.642302 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: COMMIT
[0m14:48:36.646595 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:48:36.649547 [debug] [Thread-3 (]: Using duckdb connection "model.winticket_dbt.silver_head_to_head"
[0m14:48:36.649930 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.silver_head_to_head"} */
drop view if exists "winticket"."main_silver"."silver_head_to_head__dbt_backup" cascade
[0m14:48:36.653429 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:48:36.655774 [debug] [Thread-3 (]: On model.winticket_dbt.silver_head_to_head: Close
[0m14:48:36.680804 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2760b8afd0>]}
[0m14:48:36.681795 [info ] [Thread-3 (]: 8 of 9 OK created sql view model main_silver.silver_head_to_head ............... [[32mOK[0m in 0.24s]
[0m14:48:36.682724 [debug] [Thread-3 (]: Finished running node model.winticket_dbt.silver_head_to_head
[0m14:48:36.683969 [debug] [Thread-2 (]: Began running node model.winticket_dbt.gold_entry_features
[0m14:48:36.684615 [info ] [Thread-2 (]: 9 of 9 START sql table model main_gold.gold_entry_features ..................... [RUN]
[0m14:48:36.685570 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.winticket_dbt.silver_race_metadata, now model.winticket_dbt.gold_entry_features)
[0m14:48:36.686414 [debug] [Thread-2 (]: Began compiling node model.winticket_dbt.gold_entry_features
[0m14:48:36.693262 [debug] [Thread-2 (]: Writing injected SQL for node "model.winticket_dbt.gold_entry_features"
[0m14:48:36.694203 [debug] [Thread-2 (]: Began executing node model.winticket_dbt.gold_entry_features
[0m14:48:36.717772 [debug] [Thread-2 (]: Writing runtime sql for node "model.winticket_dbt.gold_entry_features"
[0m14:48:36.719115 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:48:36.719779 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: BEGIN
[0m14:48:36.720299 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:48:36.790233 [debug] [Thread-2 (]: SQL status: OK in 0.069 seconds
[0m14:48:36.792528 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:48:36.794764 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */

  
    
    

    create  table
      "winticket"."main_gold"."gold_entry_features__dbt_tmp"
  
    as (
      

with base as (
    select
        e.*,
        m.schedule_date,
        m.schedule_day,
        m.distance_m,
        m.weather,
        m.wind_speed,
        m.entries_number,
        m.race_class,
        m.race_phase
    from "winticket"."main_silver"."silver_race_entries" e
    left join "winticket"."main_silver"."silver_race_metadata" m using (race_id)
),
odds as (
    select
        race_id,
        first_number,
        min_exacta_odds_first,
        max_exacta_odds_first,
        avg_exacta_odds_first,
        spread_exacta_odds_first,
        min_exacta_popularity_first,
        avg_exacta_popularity_first
    from "winticket"."main_silver"."silver_exacta_odds"
),
h2h as (
    select
        race_id,
        player_id,
        coalesce(field_head_to_head_wins, 0) as field_head_to_head_wins,
        coalesce(field_head_to_head_losses, 0) as field_head_to_head_losses,
        coalesce(field_head_to_head_races, 0) as field_head_to_head_races
    from "winticket"."main_silver"."silver_head_to_head"
),
picks as (
    select
        race_id,
        number,
        tipster_id,
        tipster_name,
        pick_rank
    from "winticket"."main_silver"."silver_tipster_predictions"
),
results as (
    select * from "winticket"."main_silver"."silver_race_results"
)
select
    b.race_id,
    b.cup_id,
    b.race_number,
    b.day_index,
    b.venue_slug,
    b.player_id,
    b.player_name,
    b.number,
    b.bracket_number,
    b.is_absent,
    b.schedule_date,
    b.schedule_day,
    b.distance_m,
    b.weather,
    b.wind_speed,
    b.entries_number,
    b.race_class,
    b.race_phase,
    b.age,
    b.player_class,
    b.player_group,
    b.region_id,
    b.recent_races,
    b.recent_avg_order,
    b.recent_win_rate,
    b.recent_top3_rate,
    b.venue_races,
    b.venue_avg_order,
    b.venue_win_rate,
    b.venue_top3_rate,
    coalesce(b.race_point, 0) as racePoint,
    coalesce(b.first_rate, 0) as firstRate,
    coalesce(b.second_rate, 0) as secondRate,
    coalesce(b.third_rate, 0) as thirdRate,
    coalesce(b.ex_spurt_pct, 0) as exSpurt,
    coalesce(b.ex_thrust_pct, 0) as exThrust,
    coalesce(b.ex_split_pct, 0) as exSplit,
    coalesce(b.ex_compete_pct, 0) as exCompete,
    coalesce(b.ex_leftbehind_pct, 0) as exLeftBehind,
    coalesce(b.line_first_pct, 0) as lineFirstPct,
    coalesce(b.line_single_pct, 0) as lineSinglePct,
    coalesce(o.min_exacta_odds_first, 0) as min_exacta_odds_first,
    coalesce(o.max_exacta_odds_first, 0) as max_exacta_odds_first,
    coalesce(o.avg_exacta_odds_first, 0) as avg_exacta_odds_first,
    coalesce(o.spread_exacta_odds_first, 0) as spread_exacta_odds_first,
    coalesce(o.min_exacta_popularity_first, 0) as min_exacta_popularity_first,
    coalesce(o.avg_exacta_popularity_first, 0) as avg_exacta_popularity_first,
    h.field_head_to_head_wins,
    h.field_head_to_head_losses,
    h.field_head_to_head_races,
    coalesce(p.tipster_id, 'dsc-00') as tipster_id,
    coalesce(p.tipster_name, 'N/A') as tipster_name,
    p.pick_rank,
    r.finish_order,
    case
        when r.finish_order = 1 then 1
        when r.finish_order is null then null
        else 0
    end as is_winner
from base b
left join odds o on b.race_id = o.race_id and b.number = o.first_number
left join h2h h on b.race_id = h.race_id and b.player_id = h.player_id
left join picks p on b.race_id = p.race_id and b.number = p.number
left join results r on b.race_id = r.race_id and b.player_id = r.player_id
    );
  
  
[0m14:48:39.399119 [debug] [Thread-2 (]: SQL status: OK in 2.602 seconds
[0m14:48:39.405336 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:48:39.405970 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features" rename to "gold_entry_features__dbt_backup"
[0m14:48:39.451203 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m14:48:39.458702 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:48:39.459605 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
alter table "winticket"."main_gold"."gold_entry_features__dbt_tmp" rename to "gold_entry_features"
[0m14:48:39.462091 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m14:48:39.469111 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:48:39.469813 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:48:39.470174 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: COMMIT
[0m14:48:39.496028 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m14:48:39.500040 [debug] [Thread-2 (]: Using duckdb connection "model.winticket_dbt.gold_entry_features"
[0m14:48:39.500631 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "winticket_duckdb", "target_name": "dev", "node_id": "model.winticket_dbt.gold_entry_features"} */
drop table if exists "winticket"."main_gold"."gold_entry_features__dbt_backup" cascade
[0m14:48:39.504344 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m14:48:39.506220 [debug] [Thread-2 (]: On model.winticket_dbt.gold_entry_features: Close
[0m14:48:39.604863 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0588d60c-8e39-4783-b39f-5a149a4e7c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2760b76f10>]}
[0m14:48:39.605883 [info ] [Thread-2 (]: 9 of 9 OK created sql table model main_gold.gold_entry_features ................ [[32mOK[0m in 2.92s]
[0m14:48:39.606559 [debug] [Thread-2 (]: Finished running node model.winticket_dbt.gold_entry_features
[0m14:48:39.611486 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:39.612021 [debug] [MainThread]: On master: BEGIN
[0m14:48:39.612364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:48:39.690839 [debug] [MainThread]: SQL status: OK in 0.078 seconds
[0m14:48:39.691535 [debug] [MainThread]: On master: COMMIT
[0m14:48:39.691890 [debug] [MainThread]: Using duckdb connection "master"
[0m14:48:39.692190 [debug] [MainThread]: On master: COMMIT
[0m14:48:39.692990 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:48:39.693395 [debug] [MainThread]: On master: Close
[0m14:48:39.698853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:39.699468 [debug] [MainThread]: Connection 'model.winticket_dbt.gold_entry_features' was properly closed.
[0m14:48:39.699748 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_head_to_head' was properly closed.
[0m14:48:39.700000 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_exacta_odds' was properly closed.
[0m14:48:39.700235 [debug] [MainThread]: Connection 'model.winticket_dbt.silver_tipster_predictions' was properly closed.
[0m14:48:39.700739 [info ] [MainThread]: 
[0m14:48:39.701157 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 5.84 seconds (5.84s).
[0m14:48:39.704398 [debug] [MainThread]: Command end result
[0m14:48:39.768871 [debug] [MainThread]: Wrote artifact WritableManifest to /workspace/app/winticket_dbt/target/manifest.json
[0m14:48:39.776358 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspace/app/winticket_dbt/target/semantic_manifest.json
[0m14:48:39.794296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspace/app/winticket_dbt/target/run_results.json
[0m14:48:39.795851 [info ] [MainThread]: 
[0m14:48:39.798594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:39.800749 [info ] [MainThread]: 
[0m14:48:39.802687 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:48:39.810267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9454165, "process_in_blocks": "0", "process_kernel_time": 3.269581, "process_mem_max_rss": "584796", "process_out_blocks": "0", "process_user_time": 14.300531}
[0m14:48:39.813830 [debug] [MainThread]: Command `dbt run` succeeded at 14:48:39.812705 after 6.95 seconds
[0m14:48:39.815849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2772437a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2772469090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2772468fd0>]}
[0m14:48:39.817722 [debug] [MainThread]: Flushing usage events
[0m14:48:40.918569 [debug] [MainThread]: An error was encountered while trying to flush usage events
